(self["webpackChunkmobilitydcatap_ui"]=self["webpackChunkmobilitydcatap_ui"]||[]).push([[109],{5109:function(t,e,r){const i=r(19488),n=r(67234);class a extends i{constructor(t){super(n,t)}}t.exports=a},67234:function(t,e,r){const i=r(13943),{JsonLdParser:n}=r(38690),{Transform:a}=r(28399),s="null:";function o(t){return e=>"NamedNode"!==e.termType?null:e.value.startsWith(s)?t.namedNode(e.value.slice(s.length)):null}function l(t){const e=o(t);return r=>{const i=e(r.subject),n=e(r.predicate),a=e(r.object),s=e(r.graph);return i||n||a||s?t.quad(i||r.subject,n||r.predicate,a||r.object,s||r.graph):r}}class d{constructor(t,{baseIRI:e=s,context:r=null,factory:o=i}={}){const d=new n({baseIRI:e,context:r,dataFactory:o,streamingProfile:!1});t.pipe(d);const c=l(o),h=new a({objectMode:!0,transform:(t,e,r)=>{r(null,c(t))}});return d.on("context",(t=>{Object.entries(t).forEach((([t,e])=>{h.emit("prefix",t,o.namedNode(e))}))})),d.on("error",(t=>h.destroy(t))),d.pipe(h),h}}t.exports=d},13943:function(t,e,r){const i=r(82501);t.exports=i},14313:function(t){class e{constructor(t){this.value=t||"b"+ ++e.nextId}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}e.prototype.termType="BlankNode",e.nextId=0,t.exports=e},82501:function(t,e,r){const i=r(14313),n=r(81856),a=r(4889),s=r(48736),o=r(84482),l=r(84200),d=r(46419);function c(t){return new o(t)}function h(t){return new i(t)}function u(t,e){return"string"===typeof e?-1===e.indexOf(":")?new s(t,e):new s(t,null,E.namedNode(e)):new s(t,null,e)}function f(t){return new d(t)}function p(){return E.defaultGraphInstance}function g(t,e,r){return E.quad(t,e,r)}function y(t,e,r,i){return new l(t,e,r,i||E.defaultGraphInstance)}function C(t){return a.call(E,t)}function w(t){return a.call(E,t)}const E={namedNode:c,blankNode:h,literal:u,variable:f,defaultGraph:p,triple:g,quad:y,fromTerm:C,fromQuad:w,defaultGraphInstance:new n};t.exports=E},81856:function(t){class e{equals(t){return!!t&&t.termType===this.termType}}e.prototype.termType="DefaultGraph",e.prototype.value="",t.exports=e},48736:function(t,e,r){const i=r(84482);class n{constructor(t,e,r){this.value=t,this.datatype=n.stringDatatype,this.language="",e?(this.language=e,this.datatype=n.langStringDatatype):r&&(this.datatype=r)}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}n.prototype.termType="Literal",n.langStringDatatype=new i("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),n.stringDatatype=new i("http://www.w3.org/2001/XMLSchema#string"),t.exports=n},84482:function(t){class e{constructor(t){this.value=t}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}e.prototype.termType="NamedNode",t.exports=e},84200:function(t,e,r){const i=r(81856);class n{constructor(t,e,r,n){this.subject=t,this.predicate=e,this.object=r,this.graph=n||new i}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&t.subject.equals(this.subject)&&t.predicate.equals(this.predicate)&&t.object.equals(this.object)&&t.graph.equals(this.graph)}}n.prototype.termType="Quad",n.prototype.value="",t.exports=n},46419:function(t){class e{constructor(t){this.value=t}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}e.prototype.termType="Variable",t.exports=e},4889:function(t){function e(t){if(!t)return null;if("BlankNode"===t.termType)return this.blankNode(t.value);if("DefaultGraph"===t.termType)return this.defaultGraph();if("Literal"===t.termType)return this.literal(t.value,t.language||this.namedNode(t.datatype.value));if("NamedNode"===t.termType)return this.namedNode(t.value);if("Quad"===t.termType){const e=this.fromTerm(t.subject),r=this.fromTerm(t.predicate),i=this.fromTerm(t.object),n=this.fromTerm(t.graph);return this.quad(e,r,i,n)}if("Variable"===t.termType)return this.variable(t.value);throw new Error(`unknown termType ${t.termType}`)}t.exports=e},19488:function(t){class e{constructor(t,e){this.Impl=t,this.options=e}import(t,e){const r=new this.Impl(t,Object.assign({},this.options,e));return t.on("end",(()=>{r.readable||r.emit("end")})),t.on("error",(t=>{r.emit("error",t)})),r}}t.exports=e},38690:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||i(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(r(52277),e)},4405:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextTree=void 0;class r{constructor(){this.subTrees={}}getContext(t){if(t.length>0){const[e,...r]=t,i=this.subTrees[e];if(i){const t=i.getContext(r);if(t)return t.then((({context:t,depth:e})=>({context:t,depth:e+1})))}}return this.context?this.context.then((t=>({context:t,depth:0}))):null}setContext(t,e){if(0===t.length)this.context=e;else{const[i,...n]=t;let a=this.subTrees[i];a||(a=this.subTrees[i]=new r),a.setContext(n,e)}}removeContext(t){this.setContext(t,null)}}e.ContextTree=r},52277:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdParser=void 0;const i=r(54727),n=r(42395),a=r(88310),s=r(39693),o=r(64860),l=r(22386),d=r(76970),c=r(23809),h=r(55998),u=r(15517),f=r(70736),p=r(24910),g=r(62036),y=r(86454),C=r(33283),w=r(93099),E=r(10888),x=r(2384);class S extends a.Transform{constructor(t){super({readableObjectMode:!0}),t=t||{},this.options=t,this.parsingContext=new w.ParsingContext(Object.assign({parser:this},t)),this.util=new E.Util({dataFactory:t.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new i,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners(),this.on("end",(()=>{"undefined"!==typeof this.jsonParser.mode&&this.emit("error",new Error("Unclosed document"))}))}static fromHttpResponse(t,e,r,i){let a,s;if("application/ld+json"!==e){if("application/json"!==e&&!e.endsWith("+json"))throw new n.ErrorCoded(`Unsupported JSON-LD media type ${e}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(r&&r.has("Link")&&r.forEach(((e,r)=>{if("link"===r){const r=x.parse(e);for(const e of r.get("rel","http://www.w3.org/ns/json-ld#context")){if(a)throw new n.ErrorCoded("Multiple JSON-LD context link headers were found on "+t,n.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);a=e.uri}}})),!a&&!(null===i||void 0===i?void 0:i.ignoreMissingContextLinkHeader))throw new n.ErrorCoded(`Missing context link header for media type ${e} on ${t}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}if(r&&r.has("Content-Type")){const t=r.get("Content-Type"),e=/; *profile=([^"]*)/.exec(t);e&&"http://www.w3.org/ns/json-ld#streaming"===e[1]&&(s=!0)}return new S(Object.assign({baseIRI:t,context:a,streamingProfile:s},i||{}))}import(t){const e=new a.PassThrough({readableObjectMode:!0});t.on("error",(t=>r.emit("error",t))),t.on("data",(t=>e.push(t))),t.on("end",(()=>e.push(null)));const r=e.pipe(new S(this.options));return r}_transform(t,e,r){this.jsonParser.write(t),this.lastOnValueJob.then((()=>r()),(t=>r(t)))}async newOnValueJob(t,e,r,i){let a=!0;if(i&&r<this.lastDepth){const t=this.parsingContext.listPointerStack[this.lastDepth];t&&(t.value&&this.emit("data",this.util.dataFactory.quad(t.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),t.listId.listHead=!0,this.parsingContext.idStack[t.listRootDepth+1]=[t.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await o.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),a=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}const s=await this.util.unaliasKeyword(t[r],t,r),l=await this.util.unaliasKeywordParent(t,r);this.parsingContext.emittedStack[r]=!0;let d=!0;n.Util.isValidKeyword(s)&&"@reverse"===l&&"@context"!==s&&this.emit("error",new n.ErrorCoded(`Found the @id '${e}' inside an @reverse property`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let c=!1;this.parsingContext.validationStack.length>1&&(c=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let n=Math.max(1,this.parsingContext.validationStack.length-1);n<t.length-1;n++){const e=this.parsingContext.validationStack[n]||(this.parsingContext.validationStack[n]=await this.validateKey(t.slice(0,n+1),n,c));if(!e.valid){this.parsingContext.emittedStack[r]=!1,d=!1;break}!c&&e.property&&(c=!0)}if(this.util.isLiteral(r)&&(d=!1),d)for(const n of S.ENTRY_HANDLERS){const i=await n.test(this.parsingContext,this.util,s,t,r);if(i){await n.handle(this.parsingContext,this.util,s,t,e,r,i),n.isStackProcessor()&&(this.parsingContext.processingStack[r]=!0);break}}0===r&&Array.isArray(e)&&await this.util.validateValueIndexes(e),a&&r<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=r,this.lastKeys=t,this.parsingContext.unaliasedKeywordCacheStack.splice(r-1)}flushStacks(t){this.parsingContext.processingStack.splice(t,1),this.parsingContext.processingType.splice(t,1),this.parsingContext.emittedStack.splice(t,1),this.parsingContext.idStack.splice(t,1),this.parsingContext.graphStack.splice(t+1,1),this.parsingContext.graphContainerTermStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1),this.parsingContext.validationStack.splice(t-1,2),this.parsingContext.literalStack.splice(t,this.parsingContext.literalStack.length-t)}async flushBuffer(t,e){let r=this.parsingContext.idStack[t];r||(r=this.parsingContext.idStack[t]=[this.util.dataFactory.blankNode()]);const i=this.parsingContext.unidentifiedValuesBuffer[t];if(i){for(const n of r){const r=await this.util.getDepthOffsetGraph(t,e),a=this.parsingContext.graphStack[t]||r>=0?this.parsingContext.idStack[t-r-1]:[await this.util.getGraphContainerValue(e,t)];if(a)for(const e of a){this.parsingContext.emittedStack[t]=!0;for(const r of i)r.reverse?this.parsingContext.emitQuad(t,this.util.dataFactory.quad(r.object,r.predicate,n,e)):this.parsingContext.emitQuad(t,this.util.dataFactory.quad(n,r.predicate,r.object,e))}else{const r=this.parsingContext.getUnidentifiedGraphBufferSafe(t-await this.util.getDepthOffsetGraph(t,e)-1);for(const t of i)t.reverse?r.push({object:n,predicate:t.predicate,subject:t.object}):r.push({object:t.object,predicate:t.predicate,subject:n})}}this.parsingContext.unidentifiedValuesBuffer.splice(t,1),this.parsingContext.literalStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1)}const n=this.parsingContext.unidentifiedGraphsBuffer[t];if(n){for(const e of r){const r=1!==t||"BlankNode"!==e.termType||this.parsingContext.topLevelProperties?e:this.util.getDefaultGraph();this.parsingContext.emittedStack[t]=!0;for(const e of n)this.parsingContext.emitQuad(t,this.util.dataFactory.quad(e.subject,e.predicate,e.object,r))}this.parsingContext.unidentifiedGraphsBuffer.splice(t,1)}}async validateKey(t,e,r){for(const i of S.ENTRY_HANDLERS)if(await i.validate(this.parsingContext,this.util,t,e,r))return{valid:!0,property:r||i.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=t=>{const e=this.jsonParser.stack.length,r=new Array(e+1).fill(0).map(((t,r)=>r===e?this.jsonParser.key:this.jsonParser.stack[r].key));if(!this.isParsingContextInner(e)){const i=()=>this.newOnValueJob(r,t,e,!0);if(this.parsingContext.streamingProfile||this.parsingContext.contextTree.getContext(r.slice(0,-1)))this.lastOnValueJob=this.lastOnValueJob.then(i);else if("@context"===r[e]){let t=this.contextJobs[e];t||(t=this.contextJobs[e]=[]),t.push(i)}else"@type"===r[e]||"number"===typeof r[e]&&"@type"===r[e-1]?this.typeJobs.push({job:i,keys:r.slice(0,r.length-1)}):this.contextAwaitingJobs.push({job:i,keys:r});this.parsingContext.streamingProfile||0!==e||(this.lastOnValueJob=this.lastOnValueJob.then((()=>this.executeBufferedJobs())))}},this.jsonParser.onError=t=>{this.emit("error",t)}}isParsingContextInner(t){for(let e=t;e>0;e--)if("@context"===this.jsonParser.stack[e-1].key)return!0;return!1}async executeBufferedJobs(){for(const t of this.contextJobs)if(t)for(const e of t)await e();this.parsingContext.unaliasedKeywordCacheStack.splice(0);for(const t of this.contextAwaitingJobs){if(this.typeJobs.length>0){const e=[],r=[];for(let a=0;a<this.typeJobs.length;a++){const i=this.typeJobs[a];E.Util.isPrefixArray(i.keys,t.keys)&&(e.push(i),r.push(a))}const i=e.sort(((t,e)=>t.keys.length-e.keys.length));for(const t of i)await t.job();const n=r.sort().reverse();for(const t of n)this.typeJobs.splice(t,1)}await t.job()}}}e.JsonLdParser=S,S.DEFAULT_PROCESSING_MODE="1.1",S.ENTRY_HANDLERS=[new s.EntryHandlerArrayValue,new c.EntryHandlerKeywordContext,new u.EntryHandlerKeywordId,new f.EntryHandlerKeywordIncluded,new h.EntryHandlerKeywordGraph,new p.EntryHandlerKeywordNest,new g.EntryHandlerKeywordType,new C.EntryHandlerKeywordValue,new o.EntryHandlerContainer,new y.EntryHandlerKeywordUnknownFallback,new d.EntryHandlerPredicate,new l.EntryHandlerInvalidFallback]},93099:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParsingContext=void 0;const i=r(42395),n=r(75094),a=r(4405),s=r(52277);class o{constructor(t){this.contextParser=new i.ContextParser({documentLoader:t.documentLoader,skipValidation:t.skipContextValidation}),this.streamingProfile=!!t.streamingProfile,this.baseIRI=t.baseIRI,this.produceGeneralizedRdf=!!t.produceGeneralizedRdf,this.allowSubjectList=!!t.allowSubjectList,this.processingMode=t.processingMode||s.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!t.strictValues,this.validateValueIndexes=!!t.validateValueIndexes,this.defaultGraph=t.defaultGraph,this.rdfDirection=t.rdfDirection,this.normalizeLanguageTags=t.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=t.streamingProfileAllowOutOfOrderPlainType,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new a.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=t.parser,t.context?(this.rootContext=this.parseContext(t.context),this.rootContext.then((t=>this.validateContext(t)))):this.rootContext=Promise.resolve(new i.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(t,e,r){return this.contextParser.parse(t,{baseIRI:this.baseIRI,ignoreProtection:r,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:e,processingMode:this.activeProcessingMode})}validateContext(t){const e=t.getContextRaw()["@version"];if(e){if(this.activeProcessingMode&&e>this.activeProcessingMode)throw new n.ErrorCoded(`Unsupported JSON-LD version '${e}' under active processing mode ${this.activeProcessingMode}.`,n.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&e<this.activeProcessingMode)throw new n.ErrorCoded(`Invalid JSON-LD version ${e} under active processing mode ${this.activeProcessingMode}.`,n.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=e}}async getContext(t,e=1){const r=t;while("number"===typeof t[t.length-1])t=t.slice(0,t.length-1);e&&(t=t.slice(0,-e));const n=await this.getContextPropagationAware(t),a=n.context;let s=a.getContextRaw();for(let o=n.depth;o<r.length-e;o++){const t=r[o],n=s[t];if(n&&"object"===typeof n&&"@context"in n){const a=(await this.parseContext(n,s,!0)).getContextRaw(),l=!(t in a)||a[t]["@context"]["@propagate"];!1===l&&o!==r.length-1-e||(s=a,delete s["@propagate"],s[t]=Object.assign({},s[t]),"@id"in n&&(s[t]["@id"]=n["@id"]),delete s[t]["@context"],!1!==l&&this.contextTree.setContext(r.slice(0,o+e),Promise.resolve(new i.JsonLdContextNormalized(s))))}}return new i.JsonLdContextNormalized(s)}async getContextPropagationAware(t){const e=t.length;let r,n=null;do{r=!1,n&&"@__propagateFallback"in n.context.getContextRaw()?n.context=new i.JsonLdContextNormalized(n.context.getContextRaw()["@__propagateFallback"]):(n&&(t=t.slice(0,n.depth-1)),n=await this.contextTree.getContext(t)||{context:await this.rootContext,depth:0});const e=t[t.length-1];if(e in n.context.getContextRaw()){const t=n.context.getContextRaw()[e];t&&"object"===typeof t&&"@context"in t&&(r=!0)}}while(n.depth>0&&!1===n.context.getContextRaw()["@propagate"]&&n.depth!==e&&!r);return 0===n.depth&&!1===n.context.getContextRaw()["@propagate"]&&n.depth!==e&&(n.context=new i.JsonLdContextNormalized({})),n}async newOnValueJob(t,e,r,i){await this.parser.newOnValueJob(t,e,r,i)}async handlePendingContainerFlushBuffers(){if(this.pendingContainerFlushBuffers.length>0){for(const t of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(t.depth,t.keys),this.parser.flushStacks(t.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}return!1}emitQuad(t,e){1===t&&(this.topLevelProperties=!0),this.parser.push(e)}emitError(t){this.parser.emit("error",t)}emitContext(t){this.parser.emit("context",t)}getUnidentifiedValueBufferSafe(t){let e=this.unidentifiedValuesBuffer[t];return e||(e=[],this.unidentifiedValuesBuffer[t]=e),e}getUnidentifiedGraphBufferSafe(t){let e=this.unidentifiedGraphsBuffer[t];return e||(e=[],this.unidentifiedGraphsBuffer[t]=e),e}getExpandOptions(){return o.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(t,e){const r=this.idStack[t+e];if(r&&(this.idStack[t]=r,this.emittedStack[t]=!0,delete this.idStack[t+e]),this.pendingContainerFlushBuffers.length)for(const i of this.pendingContainerFlushBuffers)i.depth>=t+e&&(i.depth-=e,i.keys.splice(t,e));this.unidentifiedValuesBuffer[t+e]&&(this.unidentifiedValuesBuffer[t]=this.unidentifiedValuesBuffer[t+e],delete this.unidentifiedValuesBuffer[t+e])}}e.ParsingContext=o,o.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}},10888:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const i=r(42395),n=r(47793),a=r(64860),s=r(82341);class o{constructor(t){this.parsingContext=t.parsingContext,this.dataFactory=t.dataFactory||new n.DataFactory,this.rdfFirst=this.dataFactory.namedNode(o.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(o.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(o.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(o.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(o.RDF+"JSON")}static getContextValue(t,e,r,i){const n=t.getContextRaw()[r];if(!n)return i;const a=n[e];return void 0===a?i:a}static getContextValueContainer(t,e){return o.getContextValue(t,"@container",e,{"@set":!0})}static getContextValueType(t,e){const r=o.getContextValue(t,"@type",e,null);return"@none"===r?null:r}static getContextValueLanguage(t,e){return o.getContextValue(t,"@language",e,t.getContextRaw()["@language"]||null)}static getContextValueDirection(t,e){return o.getContextValue(t,"@direction",e,t.getContextRaw()["@direction"]||null)}static isContextValueReverse(t,e){return!!o.getContextValue(t,"@reverse",e,null)}static getContextValueIndex(t,e){return o.getContextValue(t,"@index",e,t.getContextRaw()["@index"]||null)}static isPropertyReverse(t,e,r){return"@reverse"===r!==o.isContextValueReverse(t,e)}static isValidIri(t){return null!==t&&i.Util.isValidIri(t)}static isPrefixArray(t,e){if(t.length>e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}async validateValueIndexes(t){if(this.parsingContext.validateValueIndexes){const e={};for(const r of t)if(r&&"object"===typeof r){const t=r["@id"],n=r["@index"];if(t&&n){const r=e[t];if(r&&r!==n)throw new i.ErrorCoded(`Conflicting @index value for ${t}`,i.ERROR_CODES.CONFLICTING_INDEXES);e[t]=n}}}}async valueToTerm(t,e,r,n,a){if("@json"===o.getContextValueType(t,e))return[this.dataFactory.literal(this.valueToJsonString(r),this.rdfJson)];const s=typeof r;switch(s){case"object":if(null===r||void 0===r)return[];if(Array.isArray(r))return"@list"in o.getContextValueContainer(t,e)?0===r.length?[this.rdfNil]:this.parsingContext.idStack[n+1]||[]:(await this.validateValueIndexes(r),[]);if(t=await this.getContextSelfOrPropertyScoped(t,e),"@context"in r&&(t=await this.parsingContext.parseContext(r["@context"],(await this.parsingContext.getContext(a,0)).getContextRaw())),r=await this.unaliasKeywords(r,a,n,t),"@value"in r){let s,o,l,d,c;for(e in r){const t=r[e];switch(e){case"@value":s=t;break;case"@language":o=t;break;case"@direction":l=t;break;case"@type":d=t;break;case"@index":c=t;break;default:throw new i.ErrorCoded(`Unknown value entry '${e}' in @value: ${JSON.stringify(r)}`,i.ERROR_CODES.INVALID_VALUE_OBJECT)}}if("@json"===await this.unaliasKeyword(d,a,n,!0,t))return[this.dataFactory.literal(this.valueToJsonString(s),this.rdfJson)];if(null===s)return[];if("object"===typeof s)throw new i.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(s)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&c&&"string"!==typeof c)throw new i.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(c)}'`,i.ERROR_CODES.INVALID_INDEX_VALUE);if(o){if("string"!==typeof s)throw new i.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`,i.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!i.ContextParser.validateLanguage(o,this.parsingContext.strictValues,i.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||1===this.parsingContext.activeProcessingMode)&&(o=o.toLowerCase())}if(l){if("string"!==typeof s)throw new Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`);if(!i.ContextParser.validateDirection(l,this.parsingContext.strictValues))return[]}if(o&&l&&this.parsingContext.rdfDirection){if(d)throw new i.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(n,s,o,l))}if(o){if(d)throw new i.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(s,o)]}if(l&&this.parsingContext.rdfDirection){if(d)throw new i.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(n,s,o,l))}if(d){if("string"!==typeof d)throw new i.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(d)}'`,i.ERROR_CODES.INVALID_TYPED_VALUE);const e=this.createVocabOrBaseTerm(t,d);if(!e)throw new i.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(d)}'`,i.ERROR_CODES.INVALID_TYPED_VALUE);if("NamedNode"!==e.termType)throw new i.ErrorCoded(`Illegal value type (${e.termType}): ${d}`,i.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(s,e)]}return await this.valueToTerm(new i.JsonLdContextNormalized({}),e,s,n,a)}if("@set"in r){if(Object.keys(r).length>1)throw new i.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${e}'`,i.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}if("@list"in r){if(Object.keys(r).length>1)throw new i.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${e}'`,i.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);const t=r["@list"];return Array.isArray(t)?0===t.length?[this.rdfNil]:this.parsingContext.idStack[n+1]||[]:await this.valueToTerm(await this.parsingContext.getContext(a),e,t,n-1,a.slice(0,-1))}if("@reverse"in r&&"boolean"===typeof r["@reverse"])return[];if("@graph"in o.getContextValueContainer(await this.parsingContext.getContext(a),e)){const t=this.parsingContext.graphContainerTermStack[n+1];return t?Object.values(t):[this.dataFactory.blankNode()]}return"@id"in r?(Object.keys(r).length>1&&(t=await this.parsingContext.getContext(a,0)),"@context"in r&&(t=await this.parsingContext.parseContext(r["@context"],t.getContextRaw())),"@vocab"===r["@type"]?this.nullableTermToArray(this.createVocabOrBaseTerm(t,r["@id"])):this.nullableTermToArray(this.resourceToTerm(t,r["@id"]))):this.parsingContext.emittedStack[n+1]||r&&"object"===typeof r&&0===Object.keys(r).length?this.parsingContext.idStack[n+1]||(this.parsingContext.idStack[n+1]=[this.dataFactory.blankNode()]):[];case"string":return this.nullableTermToArray(this.stringValueToTerm(n,await this.getContextSelfOrPropertyScoped(t,e),e,r,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(n,await this.getContextSelfOrPropertyScoped(t,e),e,Boolean(r).toString(),this.dataFactory.namedNode(o.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(n,await this.getContextSelfOrPropertyScoped(t,e),e,r,this.dataFactory.namedNode(r%1===0&&r<1e21?o.XSD_INTEGER:o.XSD_DOUBLE)));default:return this.parsingContext.emitError(new Error(`Could not determine the RDF type of a ${s}`)),[]}}async getContextSelfOrPropertyScoped(t,e){const r=t.getContextRaw()[e];return r&&"object"===typeof r&&"@context"in r&&(t=await this.parsingContext.parseContext(r,t.getContextRaw(),!0)),t}nullableTermToArray(t){return t?[t]:[]}predicateToTerm(t,e){const r=t.expandTerm(e,!0,this.parsingContext.getExpandOptions());return r?"_"===r[0]&&":"===r[1]?this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(r.substr(2)):null:o.isValidIri(r)?this.dataFactory.namedNode(r):r&&this.parsingContext.strictValues?(this.parsingContext.emitError(new i.ErrorCoded(`Invalid predicate IRI: ${r}`,i.ERROR_CODES.INVALID_IRI_MAPPING)),null):null:null}resourceToTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const r=t.expandTerm(e,!1,this.parsingContext.getExpandOptions());if(!o.isValidIri(r)){if(!r||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error(`Invalid resource IRI: ${r}`))}return this.dataFactory.namedNode(r)}createVocabOrBaseTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const r=this.parsingContext.getExpandOptions();let i=t.expandTerm(e,!0,r);if(i===e&&(i=t.expandTerm(e,!1,r)),!o.isValidIri(i)){if(!i||!this.parsingContext.strictValues||i.startsWith("@"))return null;this.parsingContext.emitError(new Error(`Invalid term IRI: ${i}`))}return this.dataFactory.namedNode(i)}intToString(t,e){if("number"===typeof t){if(Number.isFinite(t)){const r=t%1===0;return!r||e&&e.value===o.XSD_DOUBLE?t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):Number(t).toString()}return t>0?"INF":"-INF"}return t}stringValueToTerm(t,e,r,i,n){const a=o.getContextValueType(e,r);if(a)if("@id"===a){if(!n)return this.resourceToTerm(e,this.intToString(i,n))}else if("@vocab"===a){if(!n)return this.createVocabOrBaseTerm(e,this.intToString(i,n))}else n=this.dataFactory.namedNode(a);if(!n){const a=o.getContextValueLanguage(e,r),s=o.getContextValueDirection(e,r);return s&&this.parsingContext.rdfDirection?this.createLanguageDirectionLiteral(t,this.intToString(i,n),a,s):this.dataFactory.literal(this.intToString(i,n),a)}return this.dataFactory.literal(this.intToString(i,n),n)}createLanguageDirectionLiteral(t,e,r,i){if("i18n-datatype"===this.parsingContext.rdfDirection)return r||(r=""),this.dataFactory.literal(e,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${r}_${i}`));{const n=this.dataFactory.blankNode(),a=this.getDefaultGraph();return this.parsingContext.emitQuad(t,this.dataFactory.quad(n,this.dataFactory.namedNode(o.RDF+"value"),this.dataFactory.literal(e),a)),r&&this.parsingContext.emitQuad(t,this.dataFactory.quad(n,this.dataFactory.namedNode(o.RDF+"language"),this.dataFactory.literal(r),a)),this.parsingContext.emitQuad(t,this.dataFactory.quad(n,this.dataFactory.namedNode(o.RDF+"direction"),this.dataFactory.literal(i),a)),n}}valueToJsonString(t){return s(t)}async unaliasKeyword(t,e,r,n,a){if(Number.isInteger(t))return t;if(!n){const t=this.parsingContext.unaliasedKeywordCacheStack[r];if(t)return t}if(!i.Util.isPotentialKeyword(t)){a=a||await this.parsingContext.getContext(e);let r=a.getContextRaw()[t];r&&"object"===typeof r&&(r=r["@id"]),i.Util.isValidKeyword(r)&&(t=r)}return n?t:this.parsingContext.unaliasedKeywordCacheStack[r]=t}async unaliasKeywordParent(t,e){return await this.unaliasKeyword(e>0&&t[e-1],t,e-1)}async unaliasKeywords(t,e,r,i){const n={};for(const a in t)n[await this.unaliasKeyword(a,e,r+1,!0,i)]=t[a];return n}isLiteral(t){for(let e=t;e>=0;e--)if(this.parsingContext.literalStack[e]||this.parsingContext.jsonLiteralStack[e])return!0;return!1}async getDepthOffsetGraph(t,e){for(let r=t-1;r>0;r--)if("@graph"===await this.unaliasKeyword(e[r],e,r)){const i=(await a.EntryHandlerContainer.getContainerHandler(this.parsingContext,e,r)).containers;return a.EntryHandlerContainer.isComplexGraphContainer(i)?-1:t-r-1}return-1}validateReverseSubject(t){if("Literal"===t.termType)throw new i.ErrorCoded(`Found illegal literal in subject position: ${t.value}`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(t,e){let r=this.getDefaultGraph();const{containers:i,depth:n}=await a.EntryHandlerContainer.getContainerHandler(this.parsingContext,t,e);if("@graph"in i){const e=a.EntryHandlerContainer.getContainerGraphIndex(i,n,t),s=this.parsingContext.graphContainerTermStack[n];if(r=s?s[e]:null,!r){let a=null;if("@id"in i){const e=await this.getContainerKey(t[n],t,n);null!==e&&(a=await this.resourceToTerm(await this.parsingContext.getContext(t),e))}a||(a=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[n]||(this.parsingContext.graphContainerTermStack[n]={}),r=this.parsingContext.graphContainerTermStack[n][e]=a}}return r}async getPropertiesDepth(t,e){let r=e;for(let i=e-1;i>0;i--)if("number"!==typeof t[i]){const e=await this.unaliasKeyword(t[i],t,i);if("@reverse"===e)return i;if("@nest"!==e)return r;r=i}return r}async getContainerKey(t,e,r){const i=await this.unaliasKeyword(t,e,r);return"@none"===i?null:i}}e.Util=o,o.XSD="http://www.w3.org/2001/XMLSchema#",o.XSD_BOOLEAN=o.XSD+"boolean",o.XSD_INTEGER=o.XSD+"integer",o.XSD_DOUBLE=o.XSD+"double",o.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"},7986:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIdentifier=void 0;class r{canCombineWithGraph(){return!0}async handle(t,e,r,i,n,a){let s;if(e.emittedStack[a+1]&&e.idStack[a+1])s=e.idStack[a+1][0];else{const t=await r.getContainerKey(i[a],i,a),n=null!==t?await r.resourceToTerm(await e.getContext(i),i[a]):r.dataFactory.blankNode();if(!n)return void(e.emittedStack[a]=!1);s=n,e.idStack[a+1]=[s]}let o=e.idStack[a];o||(o=e.idStack[a]=[]),o.some((t=>t.equals(s)))||o.push(s),await e.handlePendingContainerFlushBuffers()||(e.emittedStack[a]=!1)}}e.ContainerHandlerIdentifier=r},71977:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIndex=void 0;const i=r(42395),n=r(76970),a=r(10888);class s{canCombineWithGraph(){return!0}async handle(t,e,r,s,o,l){if(!Array.isArray(o)){const d="@graph"in t,c=await e.getContext(s),h=s[l-1],u=a.Util.getContextValueIndex(c,h);if(u){if(i.Util.isPotentialKeyword(u))throw new i.ErrorCoded(`Keywords can not be used as @index value, got: ${u}`,i.ERROR_CODES.INVALID_TERM_DEFINITION);if("string"!==typeof u)throw new i.ErrorCoded(`@index values must be strings, got: ${u}`,i.ERROR_CODES.INVALID_TERM_DEFINITION);if("object"!==typeof o){if("@id"!==a.Util.getContextValueType(c,h))throw new i.ErrorCoded(`Property-based index containers require nodes as values or strings with @type: @id, but got: ${o}`,i.ERROR_CODES.INVALID_VALUE_OBJECT);const t=r.resourceToTerm(c,o);t&&(e.idStack[l+1]=[t])}const t=r.createVocabOrBaseTerm(c,u);if(t){const i=await r.valueToTerm(c,u,await r.getContainerKey(s[l],s,l),l,s);if(d){const n=await r.getGraphContainerValue(s,l+1);for(const a of i)e.emitQuad(l,r.dataFactory.quad(n,t,a,r.getDefaultGraph()))}else for(const a of i)await n.EntryHandlerPredicate.handlePredicateObject(e,r,s,l+1,t,a,!1)}}const f=d?2:1;await e.newOnValueJob(s.slice(0,s.length-f),o,l-f,!0),await e.handlePendingContainerFlushBuffers()}e.emittedStack[l]=!1}}e.ContainerHandlerIndex=s},63847:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerLanguage=void 0;const i=r(42395);class n{canCombineWithGraph(){return!1}async handle(t,e,r,n,a,s){const o=await r.getContainerKey(n[s],n,s);if(Array.isArray(a))a=a.map((t=>({"@value":t,"@language":o})));else{if("string"!==typeof a)throw new i.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(a)}', but expected string`,i.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);a={"@value":a,"@language":o}}await e.newOnValueJob(n.slice(0,n.length-1),a,s-1,!0),e.emittedStack[s]=!1}}e.ContainerHandlerLanguage=n},47229:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerType=void 0;const i=r(76970),n=r(10888);class a{canCombineWithGraph(){return!1}async handle(t,e,r,a,s,o){if(!Array.isArray(s)){if("string"===typeof s){const t=await e.getContext(a),i=n.Util.getContextValueType(t,a[o-1]),l="@vocab"===i?await r.createVocabOrBaseTerm(t,s):await r.resourceToTerm(t,s);if(l){const t={"@id":"NamedNode"===l.termType?l.value:s};await e.newOnValueJob(a.slice(0,a.length-1),t,o-1,!0),e.idStack[o+1]=[l]}}else{const t=!!e.idStack[o+1];t||delete e.idStack[o],await e.newOnValueJob(a.slice(0,a.length-1),s,o-1,!0),t||(e.idStack[o+1]=e.idStack[o])}const t=await r.getContainerKey(a[o],a,o),l=null!==t?r.createVocabOrBaseTerm(await e.getContext(a),t):null;l&&await i.EntryHandlerPredicate.handlePredicateObject(e,r,a,o+1,r.rdfType,l,!1),await e.handlePendingContainerFlushBuffers()}e.emittedStack[o]=!1}}e.ContainerHandlerType=a},39693:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerArrayValue=void 0;const i=r(10888);class n{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return this.test(t,e,null,r,i)}async test(t,e,r,i,n){return"number"===typeof i[n]}async handle(t,e,r,n,a,s){let o=await e.unaliasKeywordParent(n,s);if("@list"===o){let r=null,i=0;for(let t=s-2;t>0;t--){const e=n[t];if("string"===typeof e||"number"===typeof e){i=t,r=e;break}}if(null!==r){const o=await e.valueToTerm(await t.getContext(n),r,a,s,n);for(const r of o)await this.handleListElement(t,e,r,a,s,n.slice(0,i),i);0===o.length&&await this.handleListElement(t,e,null,a,s,n.slice(0,i),i)}}else if("@set"===o)await t.newOnValueJob(n.slice(0,-2),a,s-2,!1);else if(void 0!==o&&"@type"!==o){for(let t=s-1;t>0;t--)if("number"!==typeof n[t]){o=await e.unaliasKeyword(n[t],n,t);break}const r=await t.getContext(n.slice(0,-1));if("@list"in i.Util.getContextValueContainer(r,o)){t.emittedStack[s+1]=!0;const r=await e.valueToTerm(await t.getContext(n),o,a,s,n);for(const i of r)await this.handleListElement(t,e,i,a,s,n.slice(0,-1),s-1);0===r.length&&await this.handleListElement(t,e,null,a,s,n.slice(0,-1),s-1)}else t.shiftStack(s,1),await t.newOnValueJob(n.slice(0,-1),a,s-1,!1),t.contextTree.removeContext(n.slice(0,-1))}}async handleListElement(t,e,r,i,n,a,s){let o=t.listPointerStack[n];if(null!==i&&null!==(await e.unaliasKeywords(i,a,n))["@value"]){if(o&&o.value){const r=e.dataFactory.blankNode();t.emitQuad(n,e.dataFactory.quad(o.value,e.rdfRest,r,e.getDefaultGraph())),o.value=r}else{const t=e.dataFactory.blankNode();o={value:t,listRootDepth:s,listId:t}}r&&t.emitQuad(n,e.dataFactory.quad(o.value,e.rdfFirst,r,e.getDefaultGraph()))}else o||(o={listRootDepth:s,listId:e.rdfNil});t.listPointerStack[n]=o}}e.EntryHandlerArrayValue=n},64860:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerContainer=void 0;const i=r(7986),n=r(71977),a=r(63847),s=r(47229),o=r(10888);class l{static isSimpleGraphContainer(t){return"@graph"in t&&("@set"in t&&2===Object.keys(t).length||1===Object.keys(t).length)}static isComplexGraphContainer(t){return"@graph"in t&&("@set"in t&&Object.keys(t).length>2||!("@set"in t)&&Object.keys(t).length>1)}static getContainerGraphIndex(t,e,r){let i=l.isSimpleGraphContainer(t),n="";for(let a=e;a<r.length;a++)i&&"number"!==typeof r[a]||(n+=":"+r[a]),i||"number"===typeof r[a]||(i=!0);return n}static async getContainerHandler(t,e,r){const i={containers:{"@set":!0},depth:r,fallback:!0};let n=!1;const a=await t.getContext(e,2);for(let s=r-1;s>=0;s--)if("number"!==typeof e[s]){const t=o.Util.getContextValue(a,"@container",e[s],!1);if(t&&l.isSimpleGraphContainer(t))return{containers:t,depth:s+1,fallback:!1};const r=o.Util.getContextValue(a,"@container",e[s-1],!1);if(r){const t="@graph"in r;for(const e in l.CONTAINER_HANDLERS)if(r[e])return t?l.CONTAINER_HANDLERS[e].canCombineWithGraph()?{containers:r,depth:s,fallback:!1}:i:n?i:{containers:r,depth:s,fallback:!1};return i}if(n)return i;n=!0}return i}static async isBufferableContainerHandler(t,e,r){const i=await l.getContainerHandler(t,e,r);return!i.fallback&&!("@graph"in i.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return!!await this.test(t,e,null,r,i)}async test(t,e,r,i,n){const a=o.Util.getContextValueContainer(await t.getContext(i,2),i[n-1]);for(const s in l.CONTAINER_HANDLERS)if(a[s])return{containers:a,handler:l.CONTAINER_HANDLERS[s]};return null}async handle(t,e,r,i,n,a,s){return s.handler.handle(s.containers,t,e,i,n,a)}}e.EntryHandlerContainer=l,l.CONTAINER_HANDLERS={"@id":new i.ContainerHandlerIdentifier,"@index":new n.ContainerHandlerIndex,"@language":new a.ContainerHandlerLanguage,"@type":new s.ContainerHandlerType}},22386:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerInvalidFallback=void 0;class r{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return!1}async test(t,e,r,i,n){return!0}async handle(t,e,r,i,n,a){t.emittedStack[a]=!1}}e.EntryHandlerInvalidFallback=r},76970:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerPredicate=void 0;const i=r(42395),n=r(10888);class a{static async handlePredicateObject(t,e,r,i,n,a,s){const o=await e.getPropertiesDepth(r,i),l=await e.getDepthOffsetGraph(i,r),d=i-l,c=t.idStack[o];if(c)for(const h of c){const c=l>=0;if(c){const r=t.idStack[d-1];if(r)for(const o of r)s?(e.validateReverseSubject(a),t.emitQuad(i,e.dataFactory.quad(a,n,h,o))):t.emitQuad(i,e.dataFactory.quad(h,n,a,o));else s?(e.validateReverseSubject(a),t.getUnidentifiedGraphBufferSafe(d-1).push({subject:a,predicate:n,object:h})):t.getUnidentifiedGraphBufferSafe(d-1).push({subject:h,predicate:n,object:a})}else{const l=await e.getGraphContainerValue(r,o);s?(e.validateReverseSubject(a),t.emitQuad(i,e.dataFactory.quad(a,n,h,l))):t.emitQuad(i,e.dataFactory.quad(h,n,a,l))}}else s&&e.validateReverseSubject(a),t.getUnidentifiedValueBufferSafe(o).push({predicate:n,object:a,reverse:s})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(t,e,r,i,a){const s=r[i];if(s){const a=await t.getContext(r);if(!t.jsonLiteralStack[i]&&await e.predicateToTerm(a,r[i]))return"@json"===n.Util.getContextValueType(a,s)&&(t.jsonLiteralStack[i+1]=!0),!0}return!1}async test(t,e,r,i,n){return i[n]}async handle(t,e,r,s,o,l,d){const c=s[l],h=await t.getContext(s),u=await e.predicateToTerm(h,r);if(u){const d=await e.valueToTerm(h,r,o,l,s);if(d.length)for(let f of d){const d=n.Util.isPropertyReverse(h,c,await e.unaliasKeywordParent(s,l));if(o){const a="@list"in n.Util.getContextValueContainer(h,r);if(a||o["@list"]){if((a&&!Array.isArray(o)&&!o["@list"]||o["@list"]&&!Array.isArray(o["@list"]))&&f!==e.rdfNil){const r=e.dataFactory.blankNode();t.emitQuad(l,e.dataFactory.quad(r,e.rdfRest,e.rdfNil,e.getDefaultGraph())),t.emitQuad(l,e.dataFactory.quad(r,e.rdfFirst,f,e.getDefaultGraph())),f=r}if(d&&!t.allowSubjectList)throw new i.ErrorCoded(`Found illegal list value in subject position at ${r}`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await a.handlePredicateObject(t,e,s,l,u,f,d)}}}}e.EntryHandlerPredicate=a},1548:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeyword=void 0;class r{constructor(t){this.keyword=t}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return!1}async test(t,e,r,i,n){return r===this.keyword}}e.EntryHandlerKeyword=r},23809:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordContext=void 0;const i=r(42395),n=r(1548);class a extends n.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(t,e,r,n,a,s){t.streamingProfile&&(t.processingStack[s]||t.processingType[s]||void 0!==t.idStack[s])&&t.emitError(new i.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",i.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));const o=t.getContext(n),l=t.parseContext(a,(await o).getContextRaw());t.contextTree.setContext(n.slice(0,-1),l),t.emitContext(a),await t.validateContext(await l)}}e.EntryHandlerKeywordContext=a},55998:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordGraph=void 0;const i=r(1548);class n extends i.EntryHandlerKeyword{constructor(){super("@graph")}async handle(t,e,r,i,n,a){t.graphStack[a+1]=!0}}e.EntryHandlerKeywordGraph=n},15517:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordId=void 0;const i=r(42395),n=r(1548);class a extends n.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(t,e,r,n,a,s){"string"!==typeof a&&t.emitError(new i.ErrorCoded(`Found illegal @id '${a}'`,i.ERROR_CODES.INVALID_ID_VALUE));const o=await e.getPropertiesDepth(n,s);void 0!==t.idStack[o]&&(t.idStack[o][0].listHead?t.emitError(new i.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${n[s-1]}'`,i.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):t.emitError(new i.ErrorCoded(`Found duplicate @ids '${t.idStack[o][0].value}' and '${a}'`,i.ERROR_CODES.COLLIDING_KEYWORDS))),t.idStack[o]=e.nullableTermToArray(await e.resourceToTerm(await t.getContext(n),a))}}e.EntryHandlerKeywordId=a},70736:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordIncluded=void 0;const i=r(42395),n=r(1548);class a extends n.EntryHandlerKeyword{constructor(){super("@included")}async handle(t,e,r,n,a,s){"object"!==typeof a&&t.emitError(new i.ErrorCoded(`Found illegal @included '${a}'`,i.ERROR_CODES.INVALID_INCLUDED_VALUE));const o=await e.unaliasKeywords(a,n,s,await t.getContext(n));"@value"in o&&t.emitError(new i.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(a)}'`,i.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in o&&t.emitError(new i.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(a)}'`,i.ERROR_CODES.INVALID_INCLUDED_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordIncluded=a},24910:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordNest=void 0;const i=r(42395),n=r(1548);class a extends n.EntryHandlerKeyword{constructor(){super("@nest")}async handle(t,e,r,n,a,s){"object"!==typeof a&&t.emitError(new i.ErrorCoded(`Found invalid @nest entry for '${r}': '${a}'`,i.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await e.unaliasKeywords(a,n,s,await t.getContext(n))&&t.emitError(new i.ErrorCoded(`Found an invalid @value node for '${r}'`,i.ERROR_CODES.INVALID_NEST_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordNest=a},62036:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordType=void 0;const i=r(42395),n=r(10888),a=r(76970),s=r(1548);class o extends s.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(t,e,r,s,o,l){const d=s[l],c=await t.getContext(s),h=e.rdfType,u=n.Util.isPropertyReverse(c,d,await e.unaliasKeywordParent(s,l)),f=Array.isArray(o)?o:[o];for(const n of f){"string"!==typeof n&&t.emitError(new i.ErrorCoded(`Found illegal @type '${n}'`,i.ERROR_CODES.INVALID_TYPE_VALUE));const r=e.createVocabOrBaseTerm(c,n);r&&await a.EntryHandlerPredicate.handlePredicateObject(t,e,s,l,h,r,u)}let p=Promise.resolve(c),g=!1;for(const i of f.sort()){const e=n.Util.getContextValue(c,"@context",i,null);e&&(g=!0,p=p.then((r=>t.parseContext(e,r.getContextRaw()))))}!t.streamingProfile||!g&&t.streamingProfileAllowOutOfOrderPlainType||!t.processingStack[l]&&!t.idStack[l]||t.emitError(new i.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",i.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),g&&(p=p.then((t=>("@propagate"in t.getContextRaw()||(t.getContextRaw()["@propagate"]=!1),!1===t.getContextRaw()["@propagate"]&&(t.getContextRaw()["@__propagateFallback"]=c.getContextRaw()),t))),t.contextTree.setContext(s.slice(0,s.length-1),p)),t.processingType[l]=!0}}e.EntryHandlerKeywordType=o},86454:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordUnknownFallback=void 0;const i=r(42395);class n{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,n,a){const s=await e.unaliasKeyword(r[n],r,n);return!!i.Util.isPotentialKeyword(s)&&!(!a&&"@list"===s)}async test(t,e,r,n,a){return i.Util.isPotentialKeyword(r)}async handle(t,e,r,a,s,o){const l=n.VALID_KEYWORDS_TYPES[r];void 0!==l?l&&typeof s!==l.type&&t.emitError(new i.ErrorCoded(`Invalid value type for '${r}' with value '${s}'`,l.errorCode)):t.strictValues&&t.emitError(new Error(`Unknown keyword '${r}' with value '${s}'`)),t.emittedStack[o]=!1}}e.EntryHandlerKeywordUnknownFallback=n,n.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:i.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:i.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null}},33283:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordValue=void 0;const i=r(1548);class n extends i.EntryHandlerKeyword{constructor(){super("@value")}async validate(t,e,r,i,n){const a=r[i];return a&&!t.literalStack[i]&&await this.test(t,e,a,r,i)&&(t.literalStack[i]=!0),super.validate(t,e,r,i,n)}async test(t,e,r,i,n){return"@value"===await e.unaliasKeyword(i[n],i.slice(0,i.length-1),n-1,!0)}async handle(t,e,r,i,n,a){t.literalStack[a]=!0,delete t.unidentifiedValuesBuffer[a],delete t.unidentifiedGraphsBuffer[a],t.emittedStack[a]=!1}}e.EntryHandlerKeywordValue=n},54727:function(t,e,r){var i=r(48287)["Buffer"],n={},a=n.LEFT_BRACE=1,s=n.RIGHT_BRACE=2,o=n.LEFT_BRACKET=3,l=n.RIGHT_BRACKET=4,d=n.COLON=5,c=n.COMMA=6,h=n.TRUE=7,u=n.FALSE=8,f=n.NULL=9,p=n.STRING=10,g=n.NUMBER=11,y=n.START=17,C=n.STOP=18,w=n.TRUE1=33,E=n.TRUE2=34,x=n.TRUE3=35,S=n.FALSE1=49,m=n.FALSE2=50,b=n.FALSE3=51,v=n.FALSE4=52,T=n.NULL1=65,R=n.NULL2=66,O=n.NULL3=67,_=n.NUMBER1=81,k=n.NUMBER3=83,I=n.STRING1=97,N=n.STRING2=98,D=n.STRING3=99,L=n.STRING4=100,V=n.STRING5=101,P=n.STRING6=102,A=n.VALUE=113,F=n.KEY=114,j=n.OBJECT=129,B=n.ARRAY=130,H="\\".charCodeAt(0),G="/".charCodeAt(0),U="\b".charCodeAt(0),K="\f".charCodeAt(0),J="\n".charCodeAt(0),M="\r".charCodeAt(0),$="\t".charCodeAt(0),q=65536;function Q(){this.tState=y,this.value=void 0,this.string=void 0,this.stringBuffer=i.alloc?i.alloc(q):new i(q),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=A,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new i(2),3:new i(3),4:new i(4)},this.offset=-1}Q.toknam=function(t){for(var e=Object.keys(n),r=0,i=e.length;r<i;r++){var a=e[r];if(n[a]===t)return a}return t&&"0x"+t.toString(16)};var X=Q.prototype;X.onError=function(t){throw t},X.charError=function(t,e){this.tState=C,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+Q.toknam(this.tState)))},X.appendStringChar=function(t){this.stringBufferOffset>=q&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=t},X.appendStringBuf=function(t,e,r){var i=t.length;"number"===typeof e&&(i="number"===typeof r?r<0?t.length-e+r:r-e:t.length-e),i<0&&(i=0),this.stringBufferOffset+i>q&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),t.copy(this.stringBuffer,this.stringBufferOffset,e,r),this.stringBufferOffset+=i},X.write=function(t){var e;"string"===typeof t&&(t=new i(t));for(var r=0,n=t.length;r<n;r++)if(this.tState===y){if(e=t[r],this.offset++,123===e)this.onToken(a,"{");else if(125===e)this.onToken(s,"}");else if(91===e)this.onToken(o,"[");else if(93===e)this.onToken(l,"]");else if(58===e)this.onToken(d,":");else if(44===e)this.onToken(c,",");else if(116===e)this.tState=w;else if(102===e)this.tState=S;else if(110===e)this.tState=T;else if(34===e)this.string="",this.stringBufferOffset=0,this.tState=I;else if(45===e)this.string="-",this.tState=_;else if(e>=48&&e<64)this.string=String.fromCharCode(e),this.tState=k;else if(32!==e&&9!==e&&10!==e&&13!==e)return this.charError(t,r)}else if(this.tState===I)if(e=t[r],this.bytes_remaining>0){for(var C=0;C<this.bytes_remaining;C++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+C]=t[C];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,r=r+C-1}else if(0===this.bytes_remaining&&e>=128){if(e<=193||e>244)return this.onError(new Error("Invalid UTF-8 character at position "+r+" in state "+Q.toknam(this.tState)));if(e>=194&&e<=223&&(this.bytes_in_sequence=2),e>=224&&e<=239&&(this.bytes_in_sequence=3),e>=240&&e<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+r>t.length){for(var A=0;A<=t.length-1-r;A++)this.temp_buffs[this.bytes_in_sequence][A]=t[r+A];this.bytes_remaining=r+this.bytes_in_sequence-t.length,r=t.length-1}else this.appendStringBuf(t,r,r+this.bytes_in_sequence),r=r+this.bytes_in_sequence-1}else if(34===e)this.tState=y,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(p,this.string),this.offset+=i.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===e)this.tState=N;else{if(!(e>=32))return this.charError(t,r);this.appendStringChar(e)}else if(this.tState===N)if(e=t[r],34===e)this.appendStringChar(e),this.tState=I;else if(92===e)this.appendStringChar(H),this.tState=I;else if(47===e)this.appendStringChar(G),this.tState=I;else if(98===e)this.appendStringChar(U),this.tState=I;else if(102===e)this.appendStringChar(K),this.tState=I;else if(110===e)this.appendStringChar(J),this.tState=I;else if(114===e)this.appendStringChar(M),this.tState=I;else if(116===e)this.appendStringChar($),this.tState=I;else{if(117!==e)return this.charError(t,r);this.unicode="",this.tState=D}else if(this.tState===D||this.tState===L||this.tState===V||this.tState===P){if(e=t[r],!(e>=48&&e<64||e>64&&e<=70||e>96&&e<=102))return this.charError(t,r);if(this.unicode+=String.fromCharCode(e),this.tState++===P){var F=parseInt(this.unicode,16);this.unicode=void 0,void 0!==this.highSurrogate&&F>=56320&&F<57344?(this.appendStringBuf(new i(String.fromCharCode(this.highSurrogate,F))),this.highSurrogate=void 0):void 0===this.highSurrogate&&F>=55296&&F<56320?this.highSurrogate=F:(void 0!==this.highSurrogate&&(this.appendStringBuf(new i(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new i(String.fromCharCode(F)))),this.tState=I}}else if(this.tState===_||this.tState===k)switch(e=t[r],e){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(e),this.tState=k;break;default:this.tState=y;var j=Number(this.string);if(isNaN(j))return this.charError(t,r);this.string.match(/[0-9]+/)==this.string&&j.toString()!=this.string?this.onToken(p,this.string):this.onToken(g,j),this.offset+=this.string.length-1,this.string=void 0,r--;break}else if(this.tState===w){if(114!==t[r])return this.charError(t,r);this.tState=E}else if(this.tState===E){if(117!==t[r])return this.charError(t,r);this.tState=x}else if(this.tState===x){if(101!==t[r])return this.charError(t,r);this.tState=y,this.onToken(h,!0),this.offset+=3}else if(this.tState===S){if(97!==t[r])return this.charError(t,r);this.tState=m}else if(this.tState===m){if(108!==t[r])return this.charError(t,r);this.tState=b}else if(this.tState===b){if(115!==t[r])return this.charError(t,r);this.tState=v}else if(this.tState===v){if(101!==t[r])return this.charError(t,r);this.tState=y,this.onToken(u,!1),this.offset+=4}else if(this.tState===T){if(117!==t[r])return this.charError(t,r);this.tState=R}else if(this.tState===R){if(108!==t[r])return this.charError(t,r);this.tState=O}else if(this.tState===O){if(108!==t[r])return this.charError(t,r);this.tState=y,this.onToken(f,null),this.offset+=3}},X.onToken=function(t,e){},X.parseError=function(t,e){this.tState=C,this.onError(new Error("Unexpected "+Q.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+Q.toknam(this.state)))},X.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},X.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=A)},X.emit=function(t){this.mode&&(this.state=c),this.onValue(t)},X.onValue=function(t){},X.onToken=function(t,e){if(this.state===A)if(t===p||t===g||t===h||t===u||t===f)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===a)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=F,this.mode=j;else if(t===o)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=B,this.state=A;else if(t===s){if(this.mode!==j)return this.parseError(t,e);this.pop()}else{if(t!==l)return this.parseError(t,e);if(this.mode!==B)return this.parseError(t,e);this.pop()}else if(this.state===F)if(t===p)this.key=e,this.state=d;else{if(t!==s)return this.parseError(t,e);this.pop()}else if(this.state===d){if(t!==d)return this.parseError(t,e);this.state=A}else{if(this.state!==c)return this.parseError(t,e);if(t===c)this.mode===B?(this.key++,this.state=A):this.mode===j&&(this.state=F);else{if(!(t===l&&this.mode===B||t===s&&this.mode===j))return this.parseError(t,e);this.pop()}}},Q.C=n,t.exports=Q}}]);
//# sourceMappingURL=109.62aa7cff.js.map