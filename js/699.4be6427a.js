(self["webpackChunkpko_rapid_triples"]=self["webpackChunkpko_rapid_triples"]||[]).push([[699],{2495:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerArrayValue=void 0;const n=i(61574),r=i(46509);class a{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,i,n,r){return this.test(t,e,null,i,n)}async test(t,e,i,n,r){return"number"===typeof n[r]}async handle(t,e,i,r,a,s){let o=await e.unaliasKeywordParent(r,s);if("@list"===o){let i=null,n=0;for(let t=s-2;t>0;t--){const e=r[t];if("string"===typeof e||"number"===typeof e){n=t,i=e;break}}if(null!==i){const o=await e.valueToTerm(await t.getContext(r),i,a,s,r);for(const i of o)await this.handleListElement(t,e,i,a,s,r.slice(0,n),n);0===o.length&&await this.handleListElement(t,e,null,a,s,r.slice(0,n),n)}}else if("@set"===o)await t.newOnValueJob(r.slice(0,-2),a,s-2,!1);else if(void 0!==o&&"@type"!==o){for(let t=s-1;t>0;t--)if("number"!==typeof r[t]){o=await e.unaliasKeyword(r[t],r,t);break}const i=await t.getContext(r.slice(0,-1));if("@list"in n.Util.getContextValueContainer(i,o)){t.emittedStack[s+1]=!0;const i=await e.valueToTerm(await t.getContext(r),o,a,s,r);for(const n of i)await this.handleListElement(t,e,n,a,s,r.slice(0,-1),s-1);0===i.length&&await this.handleListElement(t,e,null,a,s,r.slice(0,-1),s-1)}else t.shiftStack(s,1),await t.newOnValueJob(r.slice(0,-1),a,s-1,!1),t.contextTree.removeContext(r.slice(0,-1))}}async handleListElement(t,e,i,n,a,s,o){let l=t.listPointerStack[a];if(null!==n&&null!==(await e.unaliasKeywords(n,s,a))["@value"]){if(l&&l.value){const i=e.dataFactory.blankNode();t.emitQuad(a,e.dataFactory.quad(l.value,e.rdfRest,i,e.getDefaultGraph())),l.value=i}else{const t=e.dataFactory.blankNode();l={value:t,listRootDepth:o,listId:t}}i&&t.emitQuad(a,e.dataFactory.quad(l.value,e.rdfFirst,i,e.getDefaultGraph()))}else l||(l={listRootDepth:o,listId:e.rdfNil});t.listPointerStack[a]=l,t.rdfstar&&t.annotationsBuffer[a]&&t.emitError(new r.ErrorCoded("Found an illegal annotation inside a list",r.ERROR_CODES.INVALID_ANNOTATION))}}e.EntryHandlerArrayValue=a},2711:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextTree=void 0;class i{constructor(){this.subTrees={}}getContext(t){if(t.length>0){const[e,...i]=t,n=this.subTrees[e];if(n){const t=n.getContext(i);if(t)return t.then((({context:t,depth:e})=>({context:t,depth:e+1})))}}return this.context?this.context.then((t=>({context:t,depth:0}))):null}setContext(t,e){if(0===t.length)this.context=e;else{const[n,...r]=t;let a=this.subTrees[n];a||(a=this.subTrees[n]=new i),a.setContext(r,e)}}removeContext(t){this.setContext(t,null)}}e.ContextTree=i},8335:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIndex=void 0;const n=i(46509),r=i(63636),a=i(61574);class s{canCombineWithGraph(){return!0}async handle(t,e,i,s,o,l){if(!Array.isArray(o)){const d="@graph"in t,c=await e.getContext(s),u=s[l-1],h=a.Util.getContextValueIndex(c,u);if(h){if(n.Util.isPotentialKeyword(h))throw new n.ErrorCoded(`Keywords can not be used as @index value, got: ${h}`,n.ERROR_CODES.INVALID_TERM_DEFINITION);if("string"!==typeof h)throw new n.ErrorCoded(`@index values must be strings, got: ${h}`,n.ERROR_CODES.INVALID_TERM_DEFINITION);if("object"!==typeof o){if("@id"!==a.Util.getContextValueType(c,u))throw new n.ErrorCoded(`Property-based index containers require nodes as values or strings with @type: @id, but got: ${o}`,n.ERROR_CODES.INVALID_VALUE_OBJECT);const t=i.resourceToTerm(c,o);t&&(e.idStack[l+1]=[t])}const t=i.createVocabOrBaseTerm(c,h);if(t){const n=await i.valueToTerm(c,h,await i.getContainerKey(s[l],s,l),l,s);if(d){const r=await i.getGraphContainerValue(s,l+1);for(const a of n)e.emitQuad(l,i.dataFactory.quad(r,t,a,i.getDefaultGraph()))}else for(const a of n)await r.EntryHandlerPredicate.handlePredicateObject(e,i,s,l+1,t,a,!1,!1,!1)}}const f=d?2:1;await e.newOnValueJob(s.slice(0,s.length-f),o,l-f,!0),await e.handlePendingContainerFlushBuffers()}e.emittedStack[l]=!1}}e.ContainerHandlerIndex=s},9212:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordNest=void 0;const n=i(46509),r=i(37954);class a extends r.EntryHandlerKeyword{constructor(){super("@nest")}async handle(t,e,i,r,a,s){"object"!==typeof a&&t.emitError(new n.ErrorCoded(`Found invalid @nest entry for '${i}': '${a}'`,n.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await e.unaliasKeywords(a,r,s,await t.getContext(r))&&t.emitError(new n.ErrorCoded(`Found an invalid @value node for '${i}'`,n.ERROR_CODES.INVALID_NEST_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordNest=a},9316:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerInvalidFallback=void 0;class i{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,i,n,r){return!1}async test(t,e,i,n,r){return!0}async handle(t,e,i,n,r,a){t.emittedStack[a]=!1}}e.EntryHandlerInvalidFallback=i},18015:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordContext=void 0;const n=i(46509),r=i(37954);class a extends r.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(t,e,i,r,a,s){t.streamingProfile&&(t.processingStack[s]||t.processingType[s]||void 0!==t.idStack[s])&&t.emitError(new n.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",n.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));const o=t.getContext(r),l=t.parseContext(a,(await o).getContextRaw());t.contextTree.setContext(r.slice(0,-1),l),t.emitContext(a),await t.validateContext(await l)}}e.EntryHandlerKeywordContext=a},20138:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerContainer=void 0;const n=i(28756),r=i(8335),a=i(68441),s=i(74851),o=i(61574);class l{static isSimpleGraphContainer(t){return"@graph"in t&&("@set"in t&&2===Object.keys(t).length||1===Object.keys(t).length)}static isComplexGraphContainer(t){return"@graph"in t&&("@set"in t&&Object.keys(t).length>2||!("@set"in t)&&Object.keys(t).length>1)}static getContainerGraphIndex(t,e,i){let n=l.isSimpleGraphContainer(t),r="";for(let a=e;a<i.length;a++)n&&"number"!==typeof i[a]||(r+=":"+i[a]),n||"number"===typeof i[a]||(n=!0);return r}static async getContainerHandler(t,e,i){const n={containers:{"@set":!0},depth:i,fallback:!0};let r=!1;const a=await t.getContext(e,2);for(let s=i-1;s>=0;s--)if("number"!==typeof e[s]){const t=o.Util.getContextValue(a,"@container",e[s],!1);if(t&&l.isSimpleGraphContainer(t))return{containers:t,depth:s+1,fallback:!1};const i=o.Util.getContextValue(a,"@container",e[s-1],!1);if(i){const t="@graph"in i;for(const e in l.CONTAINER_HANDLERS)if(i[e])return t?l.CONTAINER_HANDLERS[e].canCombineWithGraph()?{containers:i,depth:s,fallback:!1}:n:r?n:{containers:i,depth:s,fallback:!1};return n}if(r)return n;r=!0}return n}static async isBufferableContainerHandler(t,e,i){const n=await l.getContainerHandler(t,e,i);return!n.fallback&&!("@graph"in n.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,i,n,r){return!!await this.test(t,e,null,i,n)}async test(t,e,i,n,r){const a=o.Util.getContextValueContainer(await t.getContext(n,2),n[r-1]);for(const s in l.CONTAINER_HANDLERS)if(a[s])return{containers:a,handler:l.CONTAINER_HANDLERS[s]};return null}async handle(t,e,i,n,r,a,s){return s.handler.handle(s.containers,t,e,n,r,a)}}e.EntryHandlerContainer=l,l.CONTAINER_HANDLERS={"@id":new n.ContainerHandlerIdentifier,"@index":new r.ContainerHandlerIndex,"@language":new a.ContainerHandlerLanguage,"@type":new s.ContainerHandlerType}},23073:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quad=void 0;class i{constructor(t,e,i,n){this.termType="Quad",this.value="",this.subject=t,this.predicate=e,this.object=i,this.graph=n}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&this.subject.equals(t.subject)&&this.predicate.equals(t.predicate)&&this.object.equals(t.object)&&this.graph.equals(t.graph)}}e.Quad=i},23227:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Literal=void 0;const n=i(67669);class r{constructor(t,e){this.termType="Literal",this.value=t,"string"===typeof e?(this.language=e,this.datatype=r.RDF_LANGUAGE_STRING,this.direction=""):e?"termType"in e?(this.language="",this.datatype=e,this.direction=""):(this.language=e.language,this.datatype=e.direction?r.RDF_DIRECTIONAL_LANGUAGE_STRING:r.RDF_LANGUAGE_STRING,this.direction=e.direction||""):(this.language="",this.datatype=r.XSD_STRING,this.direction="")}equals(t){return!!t&&"Literal"===t.termType&&t.value===this.value&&t.language===this.language&&(t.direction===this.direction||!t.direction&&""===this.direction)&&this.datatype.equals(t.datatype)}}e.Literal=r,r.RDF_LANGUAGE_STRING=new n.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),r.RDF_DIRECTIONAL_LANGUAGE_STRING=new n.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#dirLangString"),r.XSD_STRING=new n.NamedNode("http://www.w3.org/2001/XMLSchema#string")},25648:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordUnknownFallback=void 0;const n=i(46509);class r{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,i,r,a){const s=await e.unaliasKeyword(i[r],i,r);return!!n.Util.isPotentialKeyword(s)&&!(!a&&"@list"===s)}async test(t,e,i,r,a){return n.Util.isPotentialKeyword(i)}async handle(t,e,i,a,s,o){const l=r.VALID_KEYWORDS_TYPES[i];void 0!==l?l&&typeof s!==l.type&&t.emitError(new n.ErrorCoded(`Invalid value type for '${i}' with value '${s}'`,l.errorCode)):t.strictValues&&t.emitError(new Error(`Unknown keyword '${i}' with value '${s}'`)),t.emittedStack[o]=!1}}e.EntryHandlerKeywordUnknownFallback=r,r.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:n.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:n.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null}},28756:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIdentifier=void 0;class i{canCombineWithGraph(){return!0}async handle(t,e,i,n,r,a){let s;if(e.emittedStack[a+1]&&e.idStack[a+1])s=e.idStack[a+1][0];else{const t=await i.getContainerKey(n[a],n,a),r=null!==t?await i.resourceToTerm(await e.getContext(n),n[a]):i.dataFactory.blankNode();if(!r)return void(e.emittedStack[a]=!1);s=r,e.idStack[a+1]=[s]}let o=e.idStack[a];o||(o=e.idStack[a]=[]),o.some((t=>t.equals(s)))||o.push(s),await e.handlePendingContainerFlushBuffers()||(e.emittedStack[a]=!1)}}e.ContainerHandlerIdentifier=i},31306:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordType=void 0;const n=i(46509),r=i(61574),a=i(63636),s=i(37954);class o extends s.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(t,e,i,s,o,l){const d=s[l],c=await t.getContext(s),u=e.rdfType,h=await e.unaliasKeywordParent(s,l),f=r.Util.isPropertyReverse(c,d,h),p=r.Util.isPropertyInEmbeddedNode(h);e.validateReverseInEmbeddedNode(i,f,p);const g=r.Util.isPropertyInAnnotationObject(h),E=Array.isArray(o)?o:[o];for(const r of E){"string"!==typeof r&&t.emitError(new n.ErrorCoded(`Found illegal @type '${r}'`,n.ERROR_CODES.INVALID_TYPE_VALUE));const i=e.createVocabOrBaseTerm(c,r);i&&await a.EntryHandlerPredicate.handlePredicateObject(t,e,s,l,u,i,f,p,g)}let y=Promise.resolve(c),C=!1;for(const n of E.sort()){const e=r.Util.getContextValue(c,"@context",n,null);e&&(C=!0,y=y.then((i=>t.parseContext(e,i.getContextRaw()))))}!t.streamingProfile||!C&&t.streamingProfileAllowOutOfOrderPlainType||!t.processingStack[l]&&!t.idStack[l]||t.emitError(new n.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",n.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),C&&(y=y.then((t=>!0!==t.getContextRaw()["@propagate"]?new n.JsonLdContextNormalized(Object.assign(Object.assign({},t.getContextRaw()),{"@propagate":!1,"@__propagateFallback":c.getContextRaw()})):t)),t.contextTree.setContext(s.slice(0,s.length-1),y)),t.processingType[l]=!0}}e.EntryHandlerKeywordType=o},33073:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultGraph=void 0;class i{constructor(){this.termType="DefaultGraph",this.value=""}equals(t){return!!t&&"DefaultGraph"===t.termType}}e.DefaultGraph=i,i.INSTANCE=new i},36697:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextParser=void 0;const n=i(70742),r=i(72224),a=i(59147),s=i(52449),o=i(46405);class l{constructor(t){t=t||{},this.documentLoader=t.documentLoader||new a.FetchDocumentLoader,this.documentCache={},this.validateContext=!t.skipValidation,this.expandContentTypeToBase=!!t.expandContentTypeToBase,this.remoteContextsDepthLimit=t.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps=!("redirectSchemaOrgHttps"in t)||!!t.redirectSchemaOrgHttps}static validateLanguage(t,e,i){if("string"!==typeof t)throw new r.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(t)}'`,i);if(!o.Util.REGEX_LANGUAGE_TAG.test(t)){if(e)throw new r.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(t)}'`,i);return!1}return!0}static validateDirection(t,e){if("string"!==typeof t)throw new r.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(t)}'`,r.ERROR_CODES.INVALID_BASE_DIRECTION);if(!o.Util.REGEX_DIRECTION_TAG.test(t)){if(e)throw new r.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(t)}'`,r.ERROR_CODES.INVALID_BASE_DIRECTION);return!1}return!0}idifyReverseTerms(t){for(const e of Object.keys(t)){let i=t[e];if(i&&"object"===typeof i&&i["@reverse"]&&!i["@id"]){if("string"!==typeof i["@reverse"]||o.Util.isValidKeyword(i["@reverse"]))throw new r.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${i["@reverse"]}'`,r.ERROR_CODES.INVALID_IRI_MAPPING);i=t[e]=Object.assign(Object.assign({},i),{"@id":i["@reverse"]}),i["@id"]=i["@reverse"],o.Util.isPotentialKeyword(i["@reverse"])?delete i["@reverse"]:i["@reverse"]=!0}}return t}expandPrefixedTerms(t,e,i){const n=t.getContextRaw();for(const a of i||Object.keys(n))if(o.Util.EXPAND_KEYS_BLACKLIST.indexOf(a)<0&&!o.Util.isReservedInternalKeyword(a)){const i=n[a];if(o.Util.isPotentialKeyword(a)&&o.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(a)>=0&&("@type"!==a||"object"===typeof n[a]&&!n[a]["@protected"]&&"@set"!==n[a]["@container"]))throw new r.ErrorCoded(`Keywords can not be aliased to something else.\nTried mapping ${a} to ${JSON.stringify(i)}`,r.ERROR_CODES.KEYWORD_REDEFINITION);if(o.Util.ALIAS_RANGE_BLACKLIST.indexOf(o.Util.getContextValueId(i))>=0)throw new r.ErrorCoded(`Aliasing to certain keywords is not allowed.\nTried mapping ${a} to ${JSON.stringify(i)}`,r.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(i&&o.Util.isPotentialKeyword(o.Util.getContextValueId(i))&&!0===i["@prefix"])throw new r.ErrorCoded(`Tried to use keyword aliases as prefix: '${a}': '${JSON.stringify(i)}'`,r.ERROR_CODES.INVALID_TERM_DEFINITION);while(o.Util.isPrefixValue(n[a])){const i=n[a];let r=!1;if("string"===typeof i)n[a]=t.expandTerm(i,!0),r=r||i!==n[a];else{const s=i["@id"],l=i["@type"],d=!("@prefix"in i)||o.Util.isValidIri(a);if("@id"in i)void 0!==s&&null!==s&&"string"===typeof s&&(n[a]=Object.assign(Object.assign({},n[a]),{"@id":t.expandTerm(s,!0)}),r=r||s!==n[a]["@id"]);else if(!o.Util.isPotentialKeyword(a)&&d){const e=t.expandTerm(a,!0);e!==a&&(n[a]=Object.assign(Object.assign({},n[a]),{"@id":e}),r=!0)}if(l&&"string"===typeof l&&"@vocab"!==l&&(!i["@container"]||!i["@container"]["@type"])&&d){let i=t.expandTerm(l,!0);e&&l===i&&(i=t.expandTerm(l,!1)),i!==l&&(r=!0,n[a]=Object.assign(Object.assign({},n[a]),{"@type":i}))}}if(!r)break}}}normalize(t,{processingMode:e,normalizeLanguageTags:i}){if(i||1===e)for(const n of Object.keys(t))if("@language"===n&&"string"===typeof t[n])t[n]=t[n].toLowerCase();else{const e=t[n];if(e&&"object"===typeof e&&"string"===typeof e["@language"]){const i=e["@language"].toLowerCase();i!==e["@language"]&&(t[n]=Object.assign(Object.assign({},e),{"@language":i}))}}}containersToHash(t){for(const e of Object.keys(t)){const i=t[e];if(i&&"object"===typeof i)if("string"===typeof i["@container"])t[e]=Object.assign(Object.assign({},i),{"@container":{[i["@container"]]:!0}});else if(Array.isArray(i["@container"])){const n={};for(const t of i["@container"])n[t]=!0;t[e]=Object.assign(Object.assign({},i),{"@container":n})}}}applyScopedProtected(t,{processingMode:e},i){if(e&&e>=1.1&&t["@protected"]){for(const e of Object.keys(t))if(!o.Util.isReservedInternalKeyword(e)&&!o.Util.isPotentialKeyword(e)&&!o.Util.isTermProtected(t,e)){const n=t[e];n&&"object"===typeof n?"@protected"in t[e]||(t[e]=Object.assign(Object.assign({},t[e]),{"@protected":!0})):(t[e]={"@id":n,"@protected":!0},o.Util.isSimpleTermDefinitionPrefix(n,i)&&(t[e]=Object.assign(Object.assign({},t[e]),{"@prefix":!0})))}delete t["@protected"]}}validateKeywordRedefinitions(t,e,i,n){for(const a of null!==n&&void 0!==n?n:Object.keys(e))if(o.Util.isTermProtected(t,a)&&("string"===typeof e[a]?e[a]={"@id":e[a],"@protected":!0}:e[a]=Object.assign(Object.assign({},e[a]),{"@protected":!0}),!o.Util.deepEqual(t[a],e[a])))throw new r.ErrorCoded(`Attempted to override the protected keyword ${a} from ${JSON.stringify(o.Util.getContextValueId(t[a]))} to ${JSON.stringify(o.Util.getContextValueId(e[a]))}`,r.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}validate(t,{processingMode:e}){for(const i of Object.keys(t)){if(o.Util.isReservedInternalKeyword(i))continue;if(""===i)throw new r.ErrorCoded(`The empty term is not allowed, got: '${i}': '${JSON.stringify(t[i])}'`,r.ERROR_CODES.INVALID_TERM_DEFINITION);const n=t[i],a=typeof n;if(o.Util.isPotentialKeyword(i)){switch(i.substr(1)){case"vocab":if(null!==n&&"string"!==a)throw new r.ErrorCoded(`Found an invalid @vocab IRI: ${n}`,r.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(null!==n&&"string"!==a)throw new r.ErrorCoded(`Found an invalid @base IRI: ${t[i]}`,r.ERROR_CODES.INVALID_BASE_IRI);break;case"language":null!==n&&l.validateLanguage(n,!0,r.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(null!==n&&"number"!==a)throw new r.ErrorCoded(`Found an invalid @version number: ${n}`,r.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":null!==n&&l.validateDirection(n,!0);break;case"propagate":if(1===e)throw new r.ErrorCoded(`Found an illegal @propagate keyword: ${n}`,r.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(null!==n&&"boolean"!==a)throw new r.ErrorCoded(`Found an invalid @propagate value: ${n}`,r.ERROR_CODES.INVALID_PROPAGATE_VALUE);break}if(o.Util.isValidKeyword(i)&&o.Util.isValidKeyword(o.Util.getContextValueId(n)))throw new r.ErrorCoded(`Illegal keyword alias in term value, found: '${i}': '${o.Util.getContextValueId(n)}'`,r.ERROR_CODES.KEYWORD_REDEFINITION)}else if(null!==n)switch(a){case"string":if(o.Util.getPrefix(n,t)===i)throw new r.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.CYCLIC_IRI_MAPPING);if(o.Util.isValidIriWeak(i)){if("@type"===n)throw new r.ErrorCoded(`IRIs can not be mapped to @type, found: '${i}': '${n}'`,r.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(n)&&n!==new s.JsonLdContextNormalized(t).expandTerm(i))throw new r.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${i}': '${n}'`,r.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!o.Util.isCompactIri(i)&&!("@id"in n)&&("@id"===n["@type"]?!t["@base"]:!t["@vocab"]))throw new r.ErrorCoded(`Missing @id in context entry: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING);for(const d of Object.keys(n)){const c=n[d];if(c)switch(d){case"@id":if(o.Util.isValidKeyword(c)&&"@type"!==c&&"@id"!==c&&"@graph"!==c&&"@nest"!==c)throw new r.ErrorCoded(`Illegal keyword alias in term value, found: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIriWeak(i)){if("@type"===c)throw new r.ErrorCoded(`IRIs can not be mapped to @type, found: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(c)&&c!==new s.JsonLdContextNormalized(t).expandTerm(i))throw new r.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING)}if("string"!==typeof c)throw new r.ErrorCoded(`Detected non-string @id in context entry: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.getPrefix(c,t)===i)throw new r.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if("@type"===n["@container"]&&"@id"!==c&&"@vocab"!==c)throw new r.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${i}': '${c}'`,r.ERROR_CODES.INVALID_TYPE_MAPPING);if("string"!==typeof c)throw new r.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(a)}'`,r.ERROR_CODES.INVALID_TYPE_MAPPING);if("@id"!==c&&"@vocab"!==c&&(1===e||"@json"!==c)&&(1===e||"@none"!==c)&&("_"===c[0]||!o.Util.isValidIri(c)))throw new r.ErrorCoded(`A context @type must be an absolute IRI, found: '${i}': '${c}'`,r.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if("string"===typeof c&&n["@id"]&&n["@id"]!==c)throw new r.ErrorCoded(`Found non-matching @id and @reverse term values in '${i}':'${c}' and '${n["@id"]}'`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in n)throw new r.ErrorCoded(`@nest is not allowed in the reverse property '${i}'`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(1===e&&(Object.keys(c).length>1||o.Util.CONTAINERS_1_0.indexOf(Object.keys(c)[0])<0))throw new r.ErrorCoded(`Invalid term @container for '${i}' ('${Object.keys(c)}') in 1.0, must be only one of ${o.Util.CONTAINERS_1_0.join(", ")}`,r.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(const t of Object.keys(c)){if("@list"===t&&n["@reverse"])throw new r.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${i}'`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(o.Util.CONTAINERS.indexOf(t)<0)throw new r.ErrorCoded(`Invalid term @container for '${i}' ('${t}'), must be one of ${o.Util.CONTAINERS.join(", ")}`,r.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":l.validateLanguage(c,!0,r.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":l.validateDirection(c,!0);break;case"@prefix":if(null!==c&&"boolean"!==typeof c)throw new r.ErrorCoded(`Found an invalid term @prefix boolean in: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in n)&&!o.Util.isValidIri(i))throw new r.ErrorCoded(`Invalid @prefix definition for '${i}' ('${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(1===e||!n["@container"]||!n["@container"]["@index"])throw new r.ErrorCoded(`Attempt to add illegal key to value object: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(o.Util.isPotentialKeyword(c)&&"@nest"!==c)throw new r.ErrorCoded(`Found an invalid term @nest value in: '${i}': '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new r.ErrorCoded(`Found an invalid term value: '${i}': '${n}'`,r.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(t,e,i){return"string"===typeof t||(i&&!("@base"in t)&&e.parentContext&&"object"===typeof e.parentContext&&"@base"in e.parentContext&&(t["@base"]=e.parentContext["@base"],e.parentContext["@__baseDocument"]&&(t["@__baseDocument"]=!0)),e.baseIRI&&!e.external&&("@base"in t?null===t["@base"]||"string"!==typeof t["@base"]||o.Util.isValidIri(t["@base"])||(t["@base"]=(0,n.resolve)(t["@base"],e.parentContext&&e.parentContext["@base"]||e.baseIRI)):(t["@base"]=e.baseIRI,t["@__baseDocument"]=!0))),t}normalizeContextIri(t,e){if(!o.Util.isValidIri(t))try{t=(0,n.resolve)(t,e)}catch(i){throw new Error(`Invalid context IRI: ${t}`)}return this.redirectSchemaOrgHttps&&t.startsWith("http://schema.org")&&(t="https://schema.org/"),t}async parseInnerContexts(t,e,i){for(const a of null!==i&&void 0!==i?i:Object.keys(t)){const i=t[a];if(i&&"object"===typeof i&&"@context"in i&&null!==i["@context"]&&!e.ignoreScopedContexts){if(this.validateContext)try{const n=Object.assign(Object.assign({},t),{[a]:Object.assign({},t[a])});delete n[a]["@context"],await this.parse(i["@context"],Object.assign(Object.assign({},e),{external:!1,parentContext:n,ignoreProtection:!0,ignoreRemoteScopedContexts:!0,ignoreScopedContexts:!0}))}catch(n){throw new r.ErrorCoded(n.message,r.ERROR_CODES.INVALID_SCOPED_CONTEXT)}t[a]=Object.assign(Object.assign({},i),{"@context":(await this.parse(i["@context"],Object.assign(Object.assign({},e),{external:!1,minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:t}))).getContextRaw()})}}return t}async parse(t,e={},i={}){const{baseIRI:n,parentContext:a,external:d,processingMode:c=l.DEFAULT_PROCESSING_MODE,normalizeLanguageTags:u,ignoreProtection:h,minimalProcessing:f}=e,p=e.remoteContexts||{};if(Object.keys(p).length>=this.remoteContextsDepthLimit)throw new r.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(p),r.ERROR_CODES.CONTEXT_OVERFLOW);if(null===t||void 0===t){if(!h&&a&&o.Util.hasProtectedTerms(a))throw new r.ErrorCoded("Illegal context nullification when terms are protected",r.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new s.JsonLdContextNormalized(this.applyBaseEntry({},e,!1))}if("string"===typeof t){const i=this.normalizeContextIri(t,n),r=this.getOverriddenLoad(i,e);if(r)return new s.JsonLdContextNormalized(r);const a=await this.parse(await this.load(i),Object.assign(Object.assign({},e),{baseIRI:i,external:!0,remoteContexts:Object.assign(Object.assign({},p),{[i]:!0})}));return this.applyBaseEntry(a.getContextRaw(),e,!0),a}if(Array.isArray(t)){const i=[],r=await Promise.all(t.map(((t,r)=>{if("string"===typeof t){const a=this.normalizeContextIri(t,n);i[r]=a;const s=this.getOverriddenLoad(a,e);return s||this.load(a)}return t})));if(f)return new s.JsonLdContextNormalized(r);const o=await r.reduce(((t,n,a)=>t.then((t=>this.parse(n,Object.assign(Object.assign({},e),{baseIRI:i[a]||e.baseIRI,external:!!i[a]||e.external,parentContext:t.getContextRaw(),remoteContexts:i[a]?Object.assign(Object.assign({},p),{[i[a]]:!0}):p}),{skipValidation:a<r.length-1})))),Promise.resolve(new s.JsonLdContextNormalized(a||{})));return this.applyBaseEntry(o.getContextRaw(),e,!0),o}if("object"===typeof t){if("@context"in t)return await this.parse(t["@context"],e);if(t=Object.assign({},t),d&&delete t["@base"],this.applyBaseEntry(t,e,!0),this.containersToHash(t),f)return new s.JsonLdContextNormalized(t);let p={};if("@import"in t){if(!(c>=1.1))throw new r.ErrorCoded("Context importing is not supported in JSON-LD 1.0",r.ERROR_CODES.INVALID_CONTEXT_ENTRY);if("string"!==typeof t["@import"])throw new r.ErrorCoded("An @import value must be a string, but got "+typeof t["@import"],r.ERROR_CODES.INVALID_IMPORT_VALUE);p=await this.loadImportContext(this.normalizeContextIri(t["@import"],n)),delete t["@import"]}this.applyScopedProtected(p,{processingMode:c},s.defaultExpandOptions);const g=Object.assign(p,t);this.idifyReverseTerms(g),this.normalize(g,{processingMode:c,normalizeLanguageTags:u}),this.applyScopedProtected(g,{processingMode:c},s.defaultExpandOptions);const E=Object.keys(g),y=[];if("object"===typeof a)for(const t in a)t in g?y.push(t):g[t]=a[t];await this.parseInnerContexts(g,e,E);const C=new s.JsonLdContextNormalized(g);return(g&&g["@version"]||l.DEFAULT_PROCESSING_MODE)>=1.1&&(t["@vocab"]&&"string"===typeof t["@vocab"]||""===t["@vocab"])&&(a&&"@vocab"in a&&t["@vocab"].indexOf(":")<0?g["@vocab"]=a["@vocab"]+t["@vocab"]:(o.Util.isCompactIri(t["@vocab"])||t["@vocab"]in g)&&(g["@vocab"]=C.expandTerm(t["@vocab"],!0))),this.expandPrefixedTerms(C,this.expandContentTypeToBase,E),!h&&a&&c>=1.1&&this.validateKeywordRedefinitions(a,g,s.defaultExpandOptions,y),this.validateContext&&!i.skipValidation&&this.validate(g,{processingMode:c}),C}throw new r.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${t}`,r.ERROR_CODES.INVALID_LOCAL_CONTEXT)}async load(t){const e=this.documentCache[t];if(e)return e;let i;try{i=await this.documentLoader.load(t)}catch(n){throw new r.ErrorCoded(`Failed to load remote context ${t}: ${n.message}`,r.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in i))throw new r.ErrorCoded(`Missing @context in remote context at ${t}`,r.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[t]=i["@context"]}getOverriddenLoad(t,e){if(t in(e.remoteContexts||{})){if(e.ignoreRemoteScopedContexts)return t;throw new r.ErrorCoded("Detected a cyclic context inclusion of "+t,r.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}async loadImportContext(t){let e=await this.load(t);if("object"!==typeof e||Array.isArray(e))throw new r.ErrorCoded("An imported context must be a single object: "+t,r.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in e)throw new r.ErrorCoded("An imported context can not import another context: "+t,r.ERROR_CODES.INVALID_CONTEXT_ENTRY);return e=Object.assign({},e),this.containersToHash(e),e}}l.DEFAULT_PROCESSING_MODE=1.1,e.ContextParser=l},37198:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordIncluded=void 0;const n=i(46509),r=i(37954);class a extends r.EntryHandlerKeyword{constructor(){super("@included")}async handle(t,e,i,r,a,s){"object"!==typeof a&&t.emitError(new n.ErrorCoded(`Found illegal @included '${a}'`,n.ERROR_CODES.INVALID_INCLUDED_VALUE));const o=await e.unaliasKeywords(a,r,s,await t.getContext(r));"@value"in o&&t.emitError(new n.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(a)}'`,n.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in o&&t.emitError(new n.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(a)}'`,n.ERROR_CODES.INVALID_INCLUDED_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordIncluded=a},37954:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeyword=void 0;class i{constructor(t){this.keyword=t}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,i,n,r){return!1}async test(t,e,i,n,r){return i===this.keyword}}e.EntryHandlerKeyword=i},39631:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdParser=void 0;const n=i(50608),r=i(46509),a=i(14088),s=i(2495),o=i(20138),l=i(9316),d=i(63636),c=i(18015),u=i(85856),h=i(67947),f=i(37198),p=i(9212),g=i(31306),E=i(25648),y=i(69225),C=i(61029),I=i(61574),_=i(2384),R=i(83859);class O extends a.Transform{constructor(t){super({readableObjectMode:!0}),t=t||{},this.options=t,this.parsingContext=new C.ParsingContext(Object.assign({parser:this},t)),this.util=new I.Util({dataFactory:t.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new n,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners(),this.on("end",(()=>{"undefined"!==typeof this.jsonParser.mode&&this.emit("error",new Error("Unclosed document"))}))}static fromHttpResponse(t,e,i,n){let a,s,o=["application/activity+json"];if(n&&n.wellKnownMediaTypes&&(o=n.wellKnownMediaTypes),"application/ld+json"!==e&&!o.includes(e)){if("application/json"!==e&&!e.endsWith("+json"))throw new r.ErrorCoded(`Unsupported JSON-LD media type ${e}`,r.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(i&&i.has("Link")&&i.forEach(((e,i)=>{if("link"===i){const i=(0,_.parse)(e);for(const e of i.get("rel","http://www.w3.org/ns/json-ld#context")){if(a)throw new r.ErrorCoded("Multiple JSON-LD context link headers were found on "+t,r.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);a=e.uri}}})),!a&&!(null===n||void 0===n?void 0:n.ignoreMissingContextLinkHeader))throw new r.ErrorCoded(`Missing context link header for media type ${e} on ${t}`,r.ERROR_CODES.LOADING_DOCUMENT_FAILED)}if(i&&i.has("Content-Type")){const t=i.get("Content-Type"),e=/; *profile=([^"]*)/.exec(t);e&&"http://www.w3.org/ns/json-ld#streaming"===e[1]&&(s=!0)}return new O(Object.assign({baseIRI:t,context:a,streamingProfile:s},n||{}))}import(t){if("pipe"in t){t.on("error",(t=>e.emit("error",t)));const e=t.pipe(new O(this.options));return e}{const e=new a.PassThrough({readableObjectMode:!0});t.on("error",(t=>i.emit("error",t))),t.on("data",(t=>e.push(t))),t.on("end",(()=>e.push(null)));const i=e.pipe(new O(this.options));return i}}_transform(t,e,i){this.jsonParser.write(t),this.lastOnValueJob.then((()=>i()),(t=>i(t)))}async newOnValueJob(t,e,i,n){let a=!0;if(n&&i<this.lastDepth){const t=this.parsingContext.listPointerStack[this.lastDepth];t&&(t.value&&this.push(this.util.dataFactory.quad(t.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),t.listId.listHead=!0,this.parsingContext.idStack[t.listRootDepth+1]=[t.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await o.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),a=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}const s=await this.util.unaliasKeyword(t[i],t,i),l=await this.util.unaliasKeywordParent(t,i);this.parsingContext.emittedStack[i]=!0;let d=!0;r.Util.isValidKeyword(s)&&"@reverse"===l&&"@context"!==s&&this.emit("error",new r.ErrorCoded(`Found the @id '${e}' inside an @reverse property`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let c=!1;this.parsingContext.validationStack.length>1&&(c=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let r=Math.max(1,this.parsingContext.validationStack.length-1);r<t.length-1;r++){const e=this.parsingContext.validationStack[r]||(this.parsingContext.validationStack[r]=await this.validateKey(t.slice(0,r+1),r,c));if(!e.valid){this.parsingContext.emittedStack[i]=!1,d=!1;break}!c&&e.property&&(c=!0)}if(await this.util.isLiteral(t,i)&&(d=!1),d)for(const r of O.ENTRY_HANDLERS){const n=await r.test(this.parsingContext,this.util,s,t,i);if(n){await r.handle(this.parsingContext,this.util,s,t,e,i,n),r.isStackProcessor()&&(this.parsingContext.processingStack[i]=!0);break}}0===i&&Array.isArray(e)&&await this.util.validateValueIndexes(e),a&&i<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=i,this.lastKeys=t,this.parsingContext.unaliasedKeywordCacheStack.splice(i-1)}flushStacks(t){this.parsingContext.processingStack.splice(t,1),this.parsingContext.processingType.splice(t,1),this.parsingContext.emittedStack.splice(t,1),this.parsingContext.idStack.splice(t,1),this.parsingContext.graphStack.splice(t+1,1),this.parsingContext.graphContainerTermStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1),this.parsingContext.validationStack.splice(t-1,2),this.parsingContext.literalStack.splice(t,this.parsingContext.literalStack.length-t),this.parsingContext.annotationsBuffer.splice(t,1)}async flushBuffer(t,e){let i=this.parsingContext.idStack[t];const n=!!i;n||(i=this.parsingContext.idStack[t]=[this.util.dataFactory.blankNode()]);const a=this.parsingContext.unidentifiedValuesBuffer[t];if(a){for(const n of i){const i=await this.util.getDepthOffsetGraph(t,e),r=this.parsingContext.graphStack[t]||i>=0?this.parsingContext.idStack[t-i-1]:[await this.util.getGraphContainerValue(e,t)];if(r)for(const e of r){this.parsingContext.emittedStack[t]=!0;for(const i of a)this.util.emitQuadChecked(t,n,i.predicate,i.object,e,i.reverse,i.isEmbedded)}else{const i=this.parsingContext.getUnidentifiedGraphBufferSafe(t-await this.util.getDepthOffsetGraph(t,e)-1);for(const t of a)t.reverse?i.push({object:n,predicate:t.predicate,subject:t.object,isEmbedded:t.isEmbedded}):i.push({object:t.object,predicate:t.predicate,subject:n,isEmbedded:t.isEmbedded})}}this.parsingContext.unidentifiedValuesBuffer.splice(t,1),this.parsingContext.literalStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1)}const s=this.parsingContext.unidentifiedGraphsBuffer[t];if(s){for(const e of i){const i=1!==t||"BlankNode"!==e.termType||this.parsingContext.topLevelProperties?e:this.util.getDefaultGraph();this.parsingContext.emittedStack[t]=!0;for(const e of s)this.parsingContext.emitQuad(t,this.util.dataFactory.quad(e.subject,e.predicate,e.object,i))}this.parsingContext.unidentifiedGraphsBuffer.splice(t,1)}const o=this.parsingContext.annotationsBuffer[t];if(o){o.length>0&&1===t&&this.parsingContext.emitError(new r.ErrorCoded("Annotations can not be made on top-level nodes",r.ERROR_CODES.INVALID_ANNOTATION));const e=this.parsingContext.getAnnotationsBufferSafe(t-1);for(const t of o)e.push(t);delete this.parsingContext.annotationsBuffer[t]}}async validateKey(t,e,i){for(const n of O.ENTRY_HANDLERS)if(await n.validate(this.parsingContext,this.util,t,e,i))return{valid:!0,property:i||n.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=t=>{const e=this.jsonParser.stack.length,i=new Array(e+1).fill(0).map(((t,i)=>i===e?this.jsonParser.key:this.jsonParser.stack[i].key));if(!this.isParsingContextInner(e)){const n=()=>this.newOnValueJob(i,t,e,!0);if(this.parsingContext.streamingProfile||this.parsingContext.contextTree.getContext(i.slice(0,-1)))this.lastOnValueJob=this.lastOnValueJob.then(n);else if("@context"===i[e]){let t=this.contextJobs[e];t||(t=this.contextJobs[e]=[]),t.push(n)}else this.contextAwaitingJobs.push({job:n,keys:i,depth:e});this.parsingContext.streamingProfile||0!==e||(this.lastOnValueJob=this.lastOnValueJob.then((()=>this.executeBufferedJobs())))}},this.jsonParser.onError=t=>{this.emit("error",t)}}isParsingContextInner(t){for(let e=t;e>0;e--)if("@context"===this.jsonParser.stack[e-1].key)return!0;return!1}async executeBufferedJobs(){for(const e of this.contextJobs)if(e)for(const t of e)await t();this.parsingContext.unaliasedKeywordCacheStack.splice(0);const t=[];for(const e of this.contextAwaitingJobs)"@type"===await this.util.unaliasKeyword(e.keys[e.depth],e.keys,e.depth,!0)||"number"===typeof e.keys[e.depth]&&"@type"===await this.util.unaliasKeyword(e.keys[e.depth-1],e.keys,e.depth-1,!0)?this.typeJobs.push({job:e.job,keys:e.keys.slice(0,e.keys.length-1)}):t.push(e);for(const e of t){if(this.typeJobs.length>0){const t=[],i=[];for(let a=0;a<this.typeJobs.length;a++){const n=this.typeJobs[a];I.Util.isPrefixArray(n.keys,e.keys)&&(t.push(n),i.push(a))}const n=t.sort(((t,e)=>t.keys.length-e.keys.length));for(const e of n)await e.job();const r=i.sort().reverse();for(const e of r)this.typeJobs.splice(e,1)}await e.job()}}}e.JsonLdParser=O,O.DEFAULT_PROCESSING_MODE="1.1",O.ENTRY_HANDLERS=[new s.EntryHandlerArrayValue,new c.EntryHandlerKeywordContext,new h.EntryHandlerKeywordId,new f.EntryHandlerKeywordIncluded,new u.EntryHandlerKeywordGraph,new p.EntryHandlerKeywordNest,new g.EntryHandlerKeywordType,new y.EntryHandlerKeywordValue,new R.EntryHandlerKeywordAnnotation,new o.EntryHandlerContainer,new E.EntryHandlerKeywordUnknownFallback,new d.EntryHandlerPredicate,new l.EntryHandlerInvalidFallback]},40434:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlankNode=void 0;class i{constructor(t){this.termType="BlankNode",this.value=t}equals(t){return!!t&&"BlankNode"===t.termType&&t.value===this.value}}e.BlankNode=i},40822:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataFactory=void 0;const n=i(40434),r=i(33073),a=i(23227),s=i(67669),o=i(23073),l=i(77318);let d=0;class c{constructor(t){this.blankNodeCounter=0,t=t||{},this.blankNodePrefix=t.blankNodePrefix||`df_${d++}_`}namedNode(t){return new s.NamedNode(t)}blankNode(t){return new n.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(t,e){return new a.Literal(t,e)}variable(t){return new l.Variable(t)}defaultGraph(){return r.DefaultGraph.INSTANCE}quad(t,e,i,n){return new o.Quad(t,e,i,n||this.defaultGraph())}fromTerm(t){switch(t.termType){case"NamedNode":return this.namedNode(t.value);case"BlankNode":return this.blankNode(t.value);case"Literal":return t.language?this.literal(t.value,t.language):t.datatype.equals(a.Literal.XSD_STRING)?this.literal(t.value):this.literal(t.value,this.fromTerm(t.datatype));case"Variable":return this.variable(t.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(t.subject),this.fromTerm(t.predicate),this.fromTerm(t.object),this.fromTerm(t.graph))}}fromQuad(t){return this.fromTerm(t)}resetBlankNodeCounter(){this.blankNodeCounter=0}}e.DataFactory=c},46405:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;class i{static isCompactIri(t){return t.indexOf(":")>0&&!(t&&"#"===t[0])}static getPrefix(t,e){if(t&&"#"===t[0])return null;const i=t.indexOf(":");if(i>=0){if(t.length>i+1&&"/"===t.charAt(i+1)&&"/"===t.charAt(i+2))return null;const n=t.substr(0,i);if("_"===n)return null;if(e[n])return n}return null}static getContextValueId(t){if(null===t||"string"===typeof t)return t;const e=t["@id"];return e||null}static isSimpleTermDefinitionPrefix(t,e){return!i.isPotentialKeyword(t)&&(e.allowPrefixNonGenDelims||"string"===typeof t&&("_"===t[0]||i.isPrefixIriEndingWithGenDelim(t)))}static isPotentialKeyword(t){return"string"===typeof t&&i.KEYWORD_REGEX.test(t)}static isPrefixIriEndingWithGenDelim(t){return i.ENDS_WITH_GEN_DELIM.test(t)}static isPrefixValue(t){return t&&("string"===typeof t||t&&"object"===typeof t)}static isValidIri(t){return Boolean(t&&i.IRI_REGEX.test(t))}static isValidIriWeak(t){return!!t&&":"!==t[0]&&i.IRI_REGEX_WEAK.test(t)}static isValidKeyword(t){return i.VALID_KEYWORDS[t]}static isTermProtected(t,e){const i=t[e];return!("string"===typeof i)&&i&&i["@protected"]}static hasProtectedTerms(t){for(const e of Object.keys(t))if(i.isTermProtected(t,e))return!0;return!1}static isReservedInternalKeyword(t){return t.startsWith("@__")}static deepEqual(t,e){const i=Object.keys(t),n=Object.keys(e);return i.length===n.length&&i.every((i=>{const n=t[i],r=e[i];return n===r||null!==n&&null!==r&&"object"===typeof n&&"object"===typeof r&&this.deepEqual(n,r)}))}}i.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,i.IRI_REGEX_WEAK=/(?::[^:])|\//,i.KEYWORD_REGEX=/^@[a-z]+$/i,i.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,i.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,i.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,i.VALID_KEYWORDS={"@annotation":!0,"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},i.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],i.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],i.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],i.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],i.CONTAINERS_1_0=["@list","@set","@index"],e.Util=i},46509:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(36697),e),r(i(72224),e),r(i(59147),e),r(i(49356),e),r(i(66512),e),r(i(52449),e),r(i(46405),e)},46674:function(t,e){"use strict";const i=new Set(["_write","_writableState","writable"]);function n(t){return new Proxy(t,{has(t,e){return!i.has(e)&&Reflect.has(...arguments)},get(t,e){if(i.has(e))return;const n=Reflect.get(...arguments);return n&&"function"===typeof n.bind?n.bind(t):n},set(t,e,n){if(!i.has(e))return Reflect.set(...arguments)}})}e.A=n},49356:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},50608:function(t,e,i){var{Buffer:n}=i(48287),r={},a=r.LEFT_BRACE=1,s=r.RIGHT_BRACE=2,o=r.LEFT_BRACKET=3,l=r.RIGHT_BRACKET=4,d=r.COLON=5,c=r.COMMA=6,u=r.TRUE=7,h=r.FALSE=8,f=r.NULL=9,p=r.STRING=10,g=r.NUMBER=11,E=r.START=17,y=r.STOP=18,C=r.TRUE1=33,I=r.TRUE2=34,_=r.TRUE3=35,R=r.FALSE1=49,O=r.FALSE2=50,w=r.FALSE3=51,x=r.FALSE4=52,b=r.NULL1=65,S=r.NULL2=66,N=r.NULL3=67,v=r.NUMBER1=81,m=r.NUMBER3=83,D=r.STRING1=97,T=r.STRING2=98,A=r.STRING3=99,L=r.STRING4=100,V=r.STRING5=101,P=r.STRING6=102,k=r.VALUE=113,j=r.KEY=114,U=r.OBJECT=129,G=r.ARRAY=130,F="\\".charCodeAt(0),B="/".charCodeAt(0),M="\b".charCodeAt(0),K="\f".charCodeAt(0),$="\n".charCodeAt(0),J="\r".charCodeAt(0),H="\t".charCodeAt(0),X=65536;function Y(t){return n.alloc?n.alloc(t):new n(t)}function q(){this.tState=E,this.value=void 0,this.string=void 0,this.stringBuffer=Y(X),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=k,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:Y(2),3:Y(3),4:Y(4)},this.offset=-1}q.toknam=function(t){for(var e=Object.keys(r),i=0,n=e.length;i<n;i++){var a=e[i];if(r[a]===t)return a}return t&&"0x"+t.toString(16)};var W=q.prototype;W.onError=function(t){throw t},W.charError=function(t,e){this.tState=y,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+q.toknam(this.tState)))},W.appendStringChar=function(t){this.stringBufferOffset>=X&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=t},W.appendStringBuf=function(t,e,i){var n=t.length;"number"===typeof e&&(n="number"===typeof i?i<0?t.length-e+i:i-e:t.length-e),n<0&&(n=0),this.stringBufferOffset+n>X&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),t.copy(this.stringBuffer,this.stringBufferOffset,e,i),this.stringBufferOffset+=n},W.write=function(t){var e;"string"===typeof t&&(t=new n(t));for(var i=0,r=t.length;i<r;i++)if(this.tState===E){if(e=t[i],this.offset++,123===e)this.onToken(a,"{");else if(125===e)this.onToken(s,"}");else if(91===e)this.onToken(o,"[");else if(93===e)this.onToken(l,"]");else if(58===e)this.onToken(d,":");else if(44===e)this.onToken(c,",");else if(116===e)this.tState=C;else if(102===e)this.tState=R;else if(110===e)this.tState=b;else if(34===e)this.string="",this.stringBufferOffset=0,this.tState=D;else if(45===e)this.string="-",this.tState=v;else if(e>=48&&e<64)this.string=String.fromCharCode(e),this.tState=m;else if(32!==e&&9!==e&&10!==e&&13!==e)return this.charError(t,i)}else if(this.tState===D)if(e=t[i],this.bytes_remaining>0){for(var g=0;g<this.bytes_remaining;g++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+g]=t[g];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,i=i+g-1}else if(0===this.bytes_remaining&&e>=128){if(e<=193||e>244)return this.onError(new Error("Invalid UTF-8 character at position "+i+" in state "+q.toknam(this.tState)));if(e>=194&&e<=223&&(this.bytes_in_sequence=2),e>=224&&e<=239&&(this.bytes_in_sequence=3),e>=240&&e<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+i>t.length){for(var y=0;y<=t.length-1-i;y++)this.temp_buffs[this.bytes_in_sequence][y]=t[i+y];this.bytes_remaining=i+this.bytes_in_sequence-t.length,i=t.length-1}else this.appendStringBuf(t,i,i+this.bytes_in_sequence),i=i+this.bytes_in_sequence-1}else if(34===e)this.tState=E,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(p,this.string),this.offset+=n.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===e)this.tState=T;else{if(!(e>=32))return this.charError(t,i);this.appendStringChar(e)}else if(this.tState===T)if(e=t[i],34===e)this.appendStringChar(e),this.tState=D;else if(92===e)this.appendStringChar(F),this.tState=D;else if(47===e)this.appendStringChar(B),this.tState=D;else if(98===e)this.appendStringChar(M),this.tState=D;else if(102===e)this.appendStringChar(K),this.tState=D;else if(110===e)this.appendStringChar($),this.tState=D;else if(114===e)this.appendStringChar(J),this.tState=D;else if(116===e)this.appendStringChar(H),this.tState=D;else{if(117!==e)return this.charError(t,i);this.unicode="",this.tState=A}else if(this.tState===A||this.tState===L||this.tState===V||this.tState===P){if(e=t[i],!(e>=48&&e<64||e>64&&e<=70||e>96&&e<=102))return this.charError(t,i);if(this.unicode+=String.fromCharCode(e),this.tState++===P){var k=parseInt(this.unicode,16);this.unicode=void 0,void 0!==this.highSurrogate&&k>=56320&&k<57344?(this.appendStringBuf(new n(String.fromCharCode(this.highSurrogate,k))),this.highSurrogate=void 0):void 0===this.highSurrogate&&k>=55296&&k<56320?this.highSurrogate=k:(void 0!==this.highSurrogate&&(this.appendStringBuf(new n(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new n(String.fromCharCode(k)))),this.tState=D}}else if(this.tState===v||this.tState===m)switch(e=t[i],e){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(e),this.tState=m;break;default:this.tState=E;var j=this.numberReviver(this.string,t,i);if(j)return j;this.offset+=this.string.length-1,this.string=void 0,i--;break}else if(this.tState===C){if(114!==t[i])return this.charError(t,i);this.tState=I}else if(this.tState===I){if(117!==t[i])return this.charError(t,i);this.tState=_}else if(this.tState===_){if(101!==t[i])return this.charError(t,i);this.tState=E,this.onToken(u,!0),this.offset+=3}else if(this.tState===R){if(97!==t[i])return this.charError(t,i);this.tState=O}else if(this.tState===O){if(108!==t[i])return this.charError(t,i);this.tState=w}else if(this.tState===w){if(115!==t[i])return this.charError(t,i);this.tState=x}else if(this.tState===x){if(101!==t[i])return this.charError(t,i);this.tState=E,this.onToken(h,!1),this.offset+=4}else if(this.tState===b){if(117!==t[i])return this.charError(t,i);this.tState=S}else if(this.tState===S){if(108!==t[i])return this.charError(t,i);this.tState=N}else if(this.tState===N){if(108!==t[i])return this.charError(t,i);this.tState=E,this.onToken(f,null),this.offset+=3}},W.onToken=function(t,e){},W.parseError=function(t,e){this.tState=y,this.onError(new Error("Unexpected "+q.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+q.toknam(this.state)))},W.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},W.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=k)},W.emit=function(t){this.mode&&(this.state=c),this.onValue(t)},W.onValue=function(t){},W.onToken=function(t,e){if(this.state===k)if(t===p||t===g||t===u||t===h||t===f)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===a)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=j,this.mode=U;else if(t===o)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=G,this.state=k;else if(t===s){if(this.mode!==U)return this.parseError(t,e);this.pop()}else{if(t!==l)return this.parseError(t,e);if(this.mode!==G)return this.parseError(t,e);this.pop()}else if(this.state===j)if(t===p)this.key=e,this.state=d;else{if(t!==s)return this.parseError(t,e);this.pop()}else if(this.state===d){if(t!==d)return this.parseError(t,e);this.state=k}else{if(this.state!==c)return this.parseError(t,e);if(t===c)this.mode===G?(this.key++,this.state=k):this.mode===U&&(this.state=j);else{if(!(t===l&&this.mode===G||t===s&&this.mode===U))return this.parseError(t,e);this.pop()}}},W.numberReviver=function(t,e,i){var n=Number(t);if(isNaN(n))return this.charError(e,i);t.match(/[0-9]+/)==t&&n.toString()!=t?this.onToken(p,t):this.onToken(g,n)},q.C=r,t.exports=q},51016:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(39631),e)},52449:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultExpandOptions=e.JsonLdContextNormalized=void 0;const n=i(70742),r=i(72224),a=i(46405);class s{constructor(t){this.contextRaw=t}getContextRaw(){return this.contextRaw}expandTerm(t,i,s=e.defaultExpandOptions){const o=this.contextRaw[t];if(null===o||o&&null===o["@id"])return null;let l=!0;if(o&&i){const e=a.Util.getContextValueId(o);if(e&&e!==t){if("string"===typeof e&&(a.Util.isValidIri(e)||a.Util.isValidKeyword(e)))return e;a.Util.isPotentialKeyword(e)||(l=!1)}}const d=a.Util.getPrefix(t,this.contextRaw),c=this.contextRaw["@vocab"],u=(!!c||""===c)&&c.indexOf(":")<0,h=this.contextRaw["@base"],f=a.Util.isPotentialKeyword(t);if(d){const e=this.contextRaw[d],i=a.Util.getContextValueId(e);if(i){if("string"!==typeof e&&s.allowPrefixForcing){if("_"!==i[0]&&!f&&!e["@prefix"]&&!(t in this.contextRaw))return t}else if(!a.Util.isSimpleTermDefinitionPrefix(i,s))return t;return i+t.substr(d.length+1)}}else{if(i&&(c||""===c||s.allowVocabRelativeToBase&&h&&u)&&!f&&!a.Util.isCompactIri(t)){if(u){if(s.allowVocabRelativeToBase)return(c||h?(0,n.resolve)(c,h):"")+t;throw new r.ErrorCoded(`Relative vocab expansion for term '${t}' with vocab '${c}' is not allowed.`,r.ERROR_CODES.INVALID_VOCAB_MAPPING)}return c+t}if(!i&&h&&!f&&!a.Util.isCompactIri(t))return(0,n.resolve)(t,h)}if(l)return t;throw new r.ErrorCoded(`Invalid IRI mapping found for context entry '${t}': '${JSON.stringify(o)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(t,e){if(e&&this.contextRaw["@vocab"]&&t.startsWith(this.contextRaw["@vocab"]))return t.substr(this.contextRaw["@vocab"].length);if(!e&&this.contextRaw["@base"]&&t.startsWith(this.contextRaw["@base"]))return t.substr(this.contextRaw["@base"].length);const i={prefix:"",suffix:t};for(const n in this.contextRaw){const r=this.contextRaw[n];if(r&&!a.Util.isPotentialKeyword(n)){const s=a.Util.getContextValueId(r);if(t.startsWith(s)){const r=t.substr(s.length);if(r)r.length<i.suffix.length&&(i.prefix=n,i.suffix=r);else if(e)return n}}}return i.prefix?i.prefix+":"+i.suffix:t}}e.JsonLdContextNormalized=s,e.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}},59147:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FetchDocumentLoader=void 0;const n=i(72224),r=i(2384),a=i(70742);class s{constructor(t){this.fetcher=t}async load(t){const e=await(this.fetcher||fetch)(t,{headers:new Headers({accept:"application/ld+json"})});if(e.ok&&e.headers){let i=e.headers.get("Content-Type");if(i){const t=i.indexOf(";");t>0&&(i=i.substr(0,t))}if("application/ld+json"===i)return await e.json();if(e.headers.has("Link")){let i;if(e.headers.forEach(((e,n)=>{if("link"===n){const n=(0,r.parse)(e);for(const e of n.get("type","application/ld+json"))if("alternate"===e.rel){if(i)throw new Error("Multiple JSON-LD alternate links were found on "+t);i=(0,a.resolve)(e.uri,t)}}})),i)return this.load(i)}throw new n.ErrorCoded(`Unsupported JSON-LD media type ${i}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}throw new Error(e.statusText||`Status code: ${e.status}`)}}e.FetchDocumentLoader=s},61029:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParsingContext=void 0;const n=i(46509),r=i(72224),a=i(2711),s=i(39631);class o{constructor(t){this.contextParser=new n.ContextParser({documentLoader:t.documentLoader,skipValidation:t.skipContextValidation}),this.streamingProfile=!!t.streamingProfile,this.baseIRI=t.baseIRI,this.produceGeneralizedRdf=!!t.produceGeneralizedRdf,this.allowSubjectList=!!t.allowSubjectList,this.processingMode=t.processingMode||s.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!t.strictValues,this.validateValueIndexes=!!t.validateValueIndexes,this.defaultGraph=t.defaultGraph,this.rdfDirection=t.rdfDirection,this.normalizeLanguageTags=t.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=t.streamingProfileAllowOutOfOrderPlainType,this.rdfstar=!1!==t.rdfstar,this.rdfstarReverseInEmbedded=t.rdfstarReverseInEmbedded,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new a.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.annotationsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=t.parser,t.context?(this.rootContext=this.parseContext(t.context),this.rootContext.then((t=>this.validateContext(t)))):this.rootContext=Promise.resolve(new n.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(t,e,i){return this.contextParser.parse(t,{baseIRI:this.baseIRI,ignoreProtection:i,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:e,processingMode:this.activeProcessingMode})}validateContext(t){const e=t.getContextRaw()["@version"];if(e){if(this.activeProcessingMode&&e>this.activeProcessingMode)throw new r.ErrorCoded(`Unsupported JSON-LD version '${e}' under active processing mode ${this.activeProcessingMode}.`,r.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&e<this.activeProcessingMode)throw new r.ErrorCoded(`Invalid JSON-LD version ${e} under active processing mode ${this.activeProcessingMode}.`,r.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=e}}async getContext(t,e=1){const i=t;while("number"===typeof t[t.length-1])t=t.slice(0,t.length-1);e&&(t=t.slice(0,-e));const r=await this.getContextPropagationAware(t),a=r.context;let s=a.getContextRaw();for(let o=r.depth;o<i.length-e;o++){const t=i[o],r=s[t];if(r&&"object"===typeof r&&"@context"in r){const a=(await this.parseContext(r,s,!0)).getContextRaw(),l=!(t in a)||a[t]["@context"]["@propagate"];!1===l&&o!==i.length-1-e||(s=Object.assign({},a),delete s["@propagate"],s[t]=Object.assign({},s[t]),"@id"in r&&(s[t]["@id"]=r["@id"]),delete s[t]["@context"],!1!==l&&this.contextTree.setContext(i.slice(0,o+e),Promise.resolve(new n.JsonLdContextNormalized(s))))}}return new n.JsonLdContextNormalized(s)}async getContextPropagationAware(t){const e=t.length;let i,r=null;do{i=!1,r&&"@__propagateFallback"in r.context.getContextRaw()?r.context=new n.JsonLdContextNormalized(r.context.getContextRaw()["@__propagateFallback"]):(r&&(t=t.slice(0,r.depth-1)),r=await this.contextTree.getContext(t)||{context:await this.rootContext,depth:0});const e=t[t.length-1];if(e in r.context.getContextRaw()){const t=r.context.getContextRaw()[e];t&&"object"===typeof t&&"@context"in t&&(i=!0)}}while(r.depth>0&&!1===r.context.getContextRaw()["@propagate"]&&r.depth!==e&&!i);return 0===r.depth&&!1===r.context.getContextRaw()["@propagate"]&&r.depth!==e&&(r.context=new n.JsonLdContextNormalized({})),r}async newOnValueJob(t,e,i,n){await this.parser.newOnValueJob(t,e,i,n)}async handlePendingContainerFlushBuffers(){if(this.pendingContainerFlushBuffers.length>0){for(const t of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(t.depth,t.keys),this.parser.flushStacks(t.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}return!1}emitQuad(t,e){1===t&&(this.topLevelProperties=!0),this.parser.push(e)}emitError(t){this.parser.emit("error",t)}emitContext(t){this.parser.emit("context",t)}getUnidentifiedValueBufferSafe(t){let e=this.unidentifiedValuesBuffer[t];return e||(e=[],this.unidentifiedValuesBuffer[t]=e),e}getUnidentifiedGraphBufferSafe(t){let e=this.unidentifiedGraphsBuffer[t];return e||(e=[],this.unidentifiedGraphsBuffer[t]=e),e}getAnnotationsBufferSafe(t){let e=this.annotationsBuffer[t];return e||(e=[],this.annotationsBuffer[t]=e),e}getExpandOptions(){return o.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(t,e){const i=this.idStack[t+e];if(i&&(this.idStack[t]=i,this.emittedStack[t]=!0,delete this.idStack[t+e]),this.pendingContainerFlushBuffers.length)for(const n of this.pendingContainerFlushBuffers)n.depth>=t+e&&(n.depth-=e,n.keys.splice(t,e));this.unidentifiedValuesBuffer[t+e]&&(this.unidentifiedValuesBuffer[t]=this.unidentifiedValuesBuffer[t+e],delete this.unidentifiedValuesBuffer[t+e]),this.annotationsBuffer[t+e-1]&&(this.annotationsBuffer[t-1]||(this.annotationsBuffer[t-1]=[]),this.annotationsBuffer[t-1]=[...this.annotationsBuffer[t-1],...this.annotationsBuffer[t+e-1]],delete this.annotationsBuffer[t+e-1])}}e.ParsingContext=o,o.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}},61574:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const n=i(46509),r=i(87692),a=i(20138),s=i(82341);class o{constructor(t){this.parsingContext=t.parsingContext,this.dataFactory=t.dataFactory||new r.DataFactory,this.rdfFirst=this.dataFactory.namedNode(o.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(o.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(o.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(o.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(o.RDF+"JSON")}static getContextValue(t,e,i,n){const r=t.getContextRaw()[i];if(!r)return n;const a=r[e];return void 0===a?n:a}static getContextValueContainer(t,e){return o.getContextValue(t,"@container",e,{"@set":!0})}static getContextValueType(t,e){const i=o.getContextValue(t,"@type",e,null);return"@none"===i?null:i}static getContextValueLanguage(t,e){return o.getContextValue(t,"@language",e,t.getContextRaw()["@language"]||null)}static getContextValueDirection(t,e){return o.getContextValue(t,"@direction",e,t.getContextRaw()["@direction"]||null)}static isContextValueReverse(t,e){return!!o.getContextValue(t,"@reverse",e,null)}static getContextValueIndex(t,e){return o.getContextValue(t,"@index",e,t.getContextRaw()["@index"]||null)}static isPropertyReverse(t,e,i){return"@reverse"===i!==o.isContextValueReverse(t,e)}static isPropertyInEmbeddedNode(t){return"@id"===t}static isPropertyInAnnotationObject(t){return"@annotation"===t}static isValidIri(t){return null!==t&&n.Util.isValidIri(t)}static isPrefixArray(t,e){if(t.length>e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}async validateValueIndexes(t){if(this.parsingContext.validateValueIndexes){const e={};for(const i of t)if(i&&"object"===typeof i){const t=i["@id"],r=i["@index"];if(t&&r){const i=e[t];if(i&&i!==r)throw new n.ErrorCoded(`Conflicting @index value for ${t}`,n.ERROR_CODES.CONFLICTING_INDEXES);e[t]=r}}}}async valueToTerm(t,e,i,r,a){if("@json"===o.getContextValueType(t,e))return[this.dataFactory.literal(this.valueToJsonString(i),this.rdfJson)];const s=typeof i;switch(s){case"object":if(null===i||void 0===i)return[];if(Array.isArray(i))return"@list"in o.getContextValueContainer(t,e)?0===i.length?[this.rdfNil]:this.parsingContext.idStack[r+1]||[]:(await this.validateValueIndexes(i),[]);if(t=await this.getContextSelfOrPropertyScoped(t,e),"@context"in i&&(t=await this.parsingContext.parseContext(i["@context"],(await this.parsingContext.getContext(a,0)).getContextRaw())),i=await this.unaliasKeywords(i,a,r,t),"@value"in i){let s,o,l,d,c;for(e in i){const t=i[e];switch(e){case"@value":s=t;break;case"@language":o=t;break;case"@direction":l=t;break;case"@type":d=t;break;case"@index":c=t;break;case"@annotation":break;default:throw new n.ErrorCoded(`Unknown value entry '${e}' in @value: ${JSON.stringify(i)}`,n.ERROR_CODES.INVALID_VALUE_OBJECT)}}if("@json"===await this.unaliasKeyword(d,a,r,!0,t))return[this.dataFactory.literal(this.valueToJsonString(s),this.rdfJson)];if(null===s)return[];if("object"===typeof s)throw new n.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(s)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&c&&"string"!==typeof c)throw new n.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(c)}'`,n.ERROR_CODES.INVALID_INDEX_VALUE);if(o){if("string"!==typeof s)throw new n.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`,n.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!n.ContextParser.validateLanguage(o,this.parsingContext.strictValues,n.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||1===this.parsingContext.activeProcessingMode)&&(o=o.toLowerCase())}if(l){if("string"!==typeof s)throw new Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`);if(!n.ContextParser.validateDirection(l,this.parsingContext.strictValues))return[]}if(o&&l){if(d)throw new n.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(r,s,o,l))}if(o){if(d)throw new n.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(s,o)]}if(l){if(d)throw new n.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(r,s,o,l))}if(d){if("string"!==typeof d)throw new n.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(d)}'`,n.ERROR_CODES.INVALID_TYPED_VALUE);const e=this.createVocabOrBaseTerm(t,d);if(!e)throw new n.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(d)}'`,n.ERROR_CODES.INVALID_TYPED_VALUE);if("NamedNode"!==e.termType)throw new n.ErrorCoded(`Illegal value type (${e.termType}): ${d}`,n.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(s,e)]}return await this.valueToTerm(new n.JsonLdContextNormalized({}),e,s,r,a)}if("@set"in i){if(Object.keys(i).length>1)throw new n.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${e}'`,n.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}if("@list"in i){if(Object.keys(i).length>1)throw new n.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${e}'`,n.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);const t=i["@list"];return Array.isArray(t)?0===t.length?[this.rdfNil]:this.parsingContext.idStack[r+1]||[]:await this.valueToTerm(await this.parsingContext.getContext(a),e,t,r-1,a.slice(0,-1))}if("@reverse"in i&&"boolean"===typeof i["@reverse"])return[];if("@graph"in o.getContextValueContainer(await this.parsingContext.getContext(a),e)){const t=this.parsingContext.graphContainerTermStack[r+1];return t?Object.values(t):[this.dataFactory.blankNode()]}if("@id"in i){if(Object.keys(i).length>1&&(t=await this.parsingContext.getContext(a,0)),"@context"in i&&(t=await this.parsingContext.parseContext(i["@context"],t.getContextRaw())),"@vocab"===i["@type"])return this.nullableTermToArray(this.createVocabOrBaseTerm(t,i["@id"]));{const e=i["@id"];let a;if("object"===typeof e){if(!this.parsingContext.rdfstar)throw new n.ErrorCoded(`Found illegal @id '${i}'`,n.ERROR_CODES.INVALID_ID_VALUE);a=this.parsingContext.idStack[r+1][0]}else a=this.resourceToTerm(t,e);return this.nullableTermToArray(a)}}return this.parsingContext.emittedStack[r+1]||i&&"object"===typeof i&&0===Object.keys(i).length?this.parsingContext.idStack[r+1]||(this.parsingContext.idStack[r+1]=[this.dataFactory.blankNode()]):[];case"string":return this.nullableTermToArray(this.stringValueToTerm(r,await this.getContextSelfOrPropertyScoped(t,e),e,i,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(r,await this.getContextSelfOrPropertyScoped(t,e),e,Boolean(i).toString(),this.dataFactory.namedNode(o.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(r,await this.getContextSelfOrPropertyScoped(t,e),e,i,this.dataFactory.namedNode(i%1===0&&i<1e21?o.XSD_INTEGER:o.XSD_DOUBLE)));default:return this.parsingContext.emitError(new Error(`Could not determine the RDF type of a ${s}`)),[]}}async getContextSelfOrPropertyScoped(t,e){const i=t.getContextRaw()[e];return i&&"object"===typeof i&&"@context"in i&&(t=await this.parsingContext.parseContext(i,t.getContextRaw(),!0)),t}nullableTermToArray(t){return t?[t]:[]}predicateToTerm(t,e){const i=t.expandTerm(e,!0,this.parsingContext.getExpandOptions());return i?"_"===i[0]&&":"===i[1]?this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(i.substr(2)):null:o.isValidIri(i)?this.dataFactory.namedNode(i):i&&this.parsingContext.strictValues?(this.parsingContext.emitError(new n.ErrorCoded(`Invalid predicate IRI: ${i}`,n.ERROR_CODES.INVALID_IRI_MAPPING)),null):null:null}resourceToTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const i=t.expandTerm(e,!1,this.parsingContext.getExpandOptions());if(!o.isValidIri(i)){if(!i||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error(`Invalid resource IRI: ${i}`))}return this.dataFactory.namedNode(i)}createVocabOrBaseTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const i=this.parsingContext.getExpandOptions();let n=t.expandTerm(e,!0,i);if(n===e&&(n=t.expandTerm(e,!1,i)),!o.isValidIri(n)){if(!n||!this.parsingContext.strictValues||n.startsWith("@"))return null;this.parsingContext.emitError(new Error(`Invalid term IRI: ${n}`))}return this.dataFactory.namedNode(n)}intToString(t,e){if("number"===typeof t){if(Number.isFinite(t)){const i=t%1===0;return!i||e&&e.value===o.XSD_DOUBLE?t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):Number(t).toString()}return t>0?"INF":"-INF"}return t}stringValueToTerm(t,e,i,n,r){const a=o.getContextValueType(e,i);if(a)if("@id"===a){if(!r)return this.resourceToTerm(e,this.intToString(n,r))}else if("@vocab"===a){if(!r)return this.createVocabOrBaseTerm(e,this.intToString(n,r))}else r=this.dataFactory.namedNode(a);if(!r){const a=o.getContextValueLanguage(e,i),s=o.getContextValueDirection(e,i);return s?this.createLanguageDirectionLiteral(t,this.intToString(n,r),a,s):this.dataFactory.literal(this.intToString(n,r),a)}return this.dataFactory.literal(this.intToString(n,r),r)}createLanguageDirectionLiteral(t,e,i,n){if("i18n-datatype"===this.parsingContext.rdfDirection)return i||(i=""),this.dataFactory.literal(e,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${i}_${n}`));if("compound-literal"===this.parsingContext.rdfDirection){const r=this.dataFactory.blankNode(),a=this.getDefaultGraph();return this.parsingContext.emitQuad(t,this.dataFactory.quad(r,this.dataFactory.namedNode(o.RDF+"value"),this.dataFactory.literal(e),a)),i&&this.parsingContext.emitQuad(t,this.dataFactory.quad(r,this.dataFactory.namedNode(o.RDF+"language"),this.dataFactory.literal(i),a)),this.parsingContext.emitQuad(t,this.dataFactory.quad(r,this.dataFactory.namedNode(o.RDF+"direction"),this.dataFactory.literal(n),a)),r}return this.dataFactory.literal(e,{language:i||"",direction:n})}valueToJsonString(t){return s(t)}async unaliasKeyword(t,e,i,r,a){if(Number.isInteger(t))return t;if(!r){const t=this.parsingContext.unaliasedKeywordCacheStack[i];if(t)return t}if(!n.Util.isPotentialKeyword(t)){a=a||await this.parsingContext.getContext(e);let i=a.getContextRaw()[t];i&&"object"===typeof i&&(i=i["@id"]),n.Util.isValidKeyword(i)&&(t=i)}return r?t:this.parsingContext.unaliasedKeywordCacheStack[i]=t}async unaliasKeywordParent(t,e){return await this.unaliasKeyword(e>0&&t[e-1],t,e-1)}async unaliasKeywords(t,e,i,n){const r={};for(const a in t)r[await this.unaliasKeyword(a,e,i+1,!0,n)]=t[a];return r}async isLiteral(t,e){for(let i=e;i>=0;i--){if("@annotation"===await this.unaliasKeyword(t[i],t,i))return!1;if(this.parsingContext.literalStack[i]||this.parsingContext.jsonLiteralStack[i])return!0}return!1}async getDepthOffsetGraph(t,e){for(let i=t-1;i>0;i--)if("@graph"===await this.unaliasKeyword(e[i],e,i)){const n=(await a.EntryHandlerContainer.getContainerHandler(this.parsingContext,e,i)).containers;return a.EntryHandlerContainer.isComplexGraphContainer(n)?-1:t-i-1}return-1}validateReverseSubject(t){if("Literal"===t.termType)throw new n.ErrorCoded(`Found illegal literal in subject position: ${t.value}`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(t,e){let i=this.getDefaultGraph();const{containers:n,depth:r}=await a.EntryHandlerContainer.getContainerHandler(this.parsingContext,t,e);if("@graph"in n){const e=a.EntryHandlerContainer.getContainerGraphIndex(n,r,t),s=this.parsingContext.graphContainerTermStack[r];if(i=s?s[e]:null,!i){let a=null;if("@id"in n){const e=await this.getContainerKey(t[r],t,r);null!==e&&(a=await this.resourceToTerm(await this.parsingContext.getContext(t),e))}a||(a=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[r]||(this.parsingContext.graphContainerTermStack[r]={}),i=this.parsingContext.graphContainerTermStack[r][e]=a}}return i}async getPropertiesDepth(t,e){let i=e;for(let n=e-1;n>0;n--)if("number"!==typeof t[n]){const e=await this.unaliasKeyword(t[n],t,n);if("@reverse"===e)return n;if("@nest"!==e)return i;i=n}return i}async getContainerKey(t,e,i){const n=await this.unaliasKeyword(t,e,i);return"@none"===n?null:n}validateReverseInEmbeddedNode(t,e,i){if(i&&e&&!this.parsingContext.rdfstarReverseInEmbedded)throw new n.ErrorCoded(`Illegal reverse property in embedded node in ${t}`,n.ERROR_CODES.INVALID_EMBEDDED_NODE)}emitQuadChecked(t,e,i,r,a,s,o){let l;if(s?(this.validateReverseSubject(r),l=this.dataFactory.quad(r,i,e,a)):l=this.dataFactory.quad(e,i,r,a),o){if("DefaultGraph"!==l.graph.termType&&(l=this.dataFactory.quad(l.subject,l.predicate,l.object)),this.parsingContext.idStack[t-1])throw new n.ErrorCoded("Illegal multiple properties in an embedded node",n.ERROR_CODES.INVALID_EMBEDDED_NODE);this.parsingContext.idStack[t-1]=[l]}else this.parsingContext.emitQuad(t,l);const d=this.parsingContext.annotationsBuffer[t];if(d){for(const e of d)this.emitAnnotation(t,l,e);delete this.parsingContext.annotationsBuffer[t]}}emitAnnotation(t,e,i){let n;i.reverse?(this.validateReverseSubject(i.object),n=this.dataFactory.quad(i.object,i.predicate,e)):n=this.dataFactory.quad(e,i.predicate,i.object),this.parsingContext.emitQuad(t,n);for(const r of i.nestedAnnotations)this.emitAnnotation(t,n,r)}}e.Util=o,o.XSD="http://www.w3.org/2001/XMLSchema#",o.XSD_BOOLEAN=o.XSD+"boolean",o.XSD_INTEGER=o.XSD+"integer",o.XSD_DOUBLE=o.XSD+"double",o.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"},63636:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerPredicate=void 0;const n=i(46509),r=i(61574);class a{static async handlePredicateObject(t,e,i,r,a,s,o,l,d){const c=await e.getPropertiesDepth(i,r),u=await e.getDepthOffsetGraph(r,i),h=r-u,f=t.idStack[c];if(f&&!d)for(const n of f){const d=u>=0;if(d){const i=t.idStack[h-1];if(i)for(const t of i)e.emitQuadChecked(r,n,a,s,t,o,l);else o?(e.validateReverseSubject(s),t.getUnidentifiedGraphBufferSafe(h-1).push({subject:s,predicate:a,object:n,isEmbedded:l})):t.getUnidentifiedGraphBufferSafe(h-1).push({subject:n,predicate:a,object:s,isEmbedded:l})}else{const t=await e.getGraphContainerValue(i,c);e.emitQuadChecked(r,n,a,s,t,o,l)}}else if(o&&e.validateReverseSubject(s),d){if(t.rdfstar){t.idStack[r]&&t.emitError(new n.ErrorCoded(`Found an illegal @id inside an annotation: ${t.idStack[r][0].value}`,n.ERROR_CODES.INVALID_ANNOTATION));for(let a=0;a<r;a++)"@id"===await e.unaliasKeyword(i[a],i,a)&&t.emitError(new n.ErrorCoded("Found an illegal annotation inside an embedded node",n.ERROR_CODES.INVALID_ANNOTATION));const l=t.getAnnotationsBufferSafe(c),d={predicate:a,object:s,reverse:o,nestedAnnotations:[],depth:c};l.push(d);for(let t=l.length-2;t>=0;t--){const e=l[t];e.depth>c&&(d.nestedAnnotations.push(e),l.splice(t,1))}}}else t.getUnidentifiedValueBufferSafe(c).push({predicate:a,object:s,reverse:o,isEmbedded:l})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(t,e,i,n,a){const s=i[n];if(s){const a=await t.getContext(i);if(!t.jsonLiteralStack[n]&&await e.predicateToTerm(a,i[n]))return"@json"===r.Util.getContextValueType(a,s)&&(t.jsonLiteralStack[n+1]=!0),!0}return!1}async test(t,e,i,n,r){return n[r]}async handle(t,e,i,s,o,l,d){const c=s[l],u=await t.getContext(s),h=await e.predicateToTerm(u,i);if(h){const d=await e.valueToTerm(u,i,o,l,s);if(d.length)for(let f of d){let d=await e.unaliasKeywordParent(s,l);const p=r.Util.isPropertyReverse(u,c,d);let g=0;while("@reverse"===d||"number"===typeof d)"number"===typeof d?g++:l--,d=await e.unaliasKeywordParent(s,l-g);const E=r.Util.isPropertyInEmbeddedNode(d);e.validateReverseInEmbeddedNode(i,p,E);const y=r.Util.isPropertyInAnnotationObject(d);if(o){const a="@list"in r.Util.getContextValueContainer(u,i);if(a||o["@list"]){if((a&&!Array.isArray(o)&&!o["@list"]||o["@list"]&&!Array.isArray(o["@list"]))&&f!==e.rdfNil){const i=e.dataFactory.blankNode();t.emitQuad(l,e.dataFactory.quad(i,e.rdfRest,e.rdfNil,e.getDefaultGraph())),t.emitQuad(l,e.dataFactory.quad(i,e.rdfFirst,f,e.getDefaultGraph())),f=i}if(p&&!t.allowSubjectList)throw new n.ErrorCoded(`Found illegal list value in subject position at ${i}`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await a.handlePredicateObject(t,e,s,l,h,f,p,E,y)}}}}e.EntryHandlerPredicate=a},66512:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},67669:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NamedNode=void 0;class i{constructor(t){this.termType="NamedNode",this.value=t}equals(t){return!!t&&"NamedNode"===t.termType&&t.value===this.value}}e.NamedNode=i},67947:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordId=void 0;const n=i(46509),r=i(37954);class a extends r.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(t,e,i,r,a,s){if("string"!==typeof a){if(t.rdfstar&&"object"===typeof a){const e=Object.keys(a);1===e.length&&"@id"===e[0]&&t.emitError(new n.ErrorCoded(`Invalid embedded node without property with @id ${a["@id"]}`,n.ERROR_CODES.INVALID_EMBEDDED_NODE))}else t.emitError(new n.ErrorCoded(`Found illegal @id '${a}'`,n.ERROR_CODES.INVALID_ID_VALUE));return}const o=await e.getPropertiesDepth(r,s);if(void 0!==t.idStack[o]&&(t.idStack[o][0].listHead?t.emitError(new n.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${r[s-1]}'`,n.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):t.emitError(new n.ErrorCoded(`Found duplicate @ids '${t.idStack[o][0].value}' and '${a}'`,n.ERROR_CODES.COLLIDING_KEYWORDS))),t.rdfstar&&t.annotationsBuffer[s])for(const l of t.annotationsBuffer[s])l.depth===s&&t.emitError(new n.ErrorCoded(`Found an illegal @id inside an annotation: ${a}`,n.ERROR_CODES.INVALID_ANNOTATION));t.idStack[o]=e.nullableTermToArray(await e.resourceToTerm(await t.getContext(r),a))}}e.EntryHandlerKeywordId=a},68441:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerLanguage=void 0;const n=i(46509);class r{canCombineWithGraph(){return!1}async handle(t,e,i,r,a,s){const o=await i.getContainerKey(r[s],r,s);if(Array.isArray(a))a=a.map((t=>({"@value":t,"@language":o})));else{if("string"!==typeof a)throw new n.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(a)}', but expected string`,n.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);a={"@value":a,"@language":o}}await e.newOnValueJob(r.slice(0,r.length-1),a,s-1,!0),e.emittedStack[s]=!1}}e.ContainerHandlerLanguage=r},69225:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordValue=void 0;const n=i(37954);class r extends n.EntryHandlerKeyword{constructor(){super("@value")}async validate(t,e,i,n,r){const a=i[n];return a&&!t.literalStack[n]&&await this.test(t,e,a,i,n)&&(t.literalStack[n]=!0),super.validate(t,e,i,n,r)}async test(t,e,i,n,r){return"@value"===await e.unaliasKeyword(n[r],n.slice(0,n.length-1),r-1,!0)}async handle(t,e,i,n,r,a){t.literalStack[a]=!0,delete t.unidentifiedValuesBuffer[a],delete t.unidentifiedGraphsBuffer[a],t.emittedStack[a]=!1}}e.EntryHandlerKeywordValue=r},72224:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ERROR_CODES=e.ErrorCoded=void 0;class i extends Error{constructor(t,e){super(t),this.code=e}}e.ErrorCoded=i,function(t){t["COLLIDING_KEYWORDS"]="colliding keywords",t["CONFLICTING_INDEXES"]="conflicting indexes",t["CYCLIC_IRI_MAPPING"]="cyclic IRI mapping",t["INVALID_ID_VALUE"]="invalid @id value",t["INVALID_INDEX_VALUE"]="invalid @index value",t["INVALID_NEST_VALUE"]="invalid @nest value",t["INVALID_PREFIX_VALUE"]="invalid @prefix value",t["INVALID_PROPAGATE_VALUE"]="invalid @propagate value",t["INVALID_REVERSE_VALUE"]="invalid @reverse value",t["INVALID_IMPORT_VALUE"]="invalid @import value",t["INVALID_VERSION_VALUE"]="invalid @version value",t["INVALID_BASE_IRI"]="invalid base IRI",t["INVALID_CONTAINER_MAPPING"]="invalid container mapping",t["INVALID_CONTEXT_ENTRY"]="invalid context entry",t["INVALID_CONTEXT_NULLIFICATION"]="invalid context nullification",t["INVALID_DEFAULT_LANGUAGE"]="invalid default language",t["INVALID_INCLUDED_VALUE"]="invalid @included value",t["INVALID_IRI_MAPPING"]="invalid IRI mapping",t["INVALID_JSON_LITERAL"]="invalid JSON literal",t["INVALID_KEYWORD_ALIAS"]="invalid keyword alias",t["INVALID_LANGUAGE_MAP_VALUE"]="invalid language map value",t["INVALID_LANGUAGE_MAPPING"]="invalid language mapping",t["INVALID_LANGUAGE_TAGGED_STRING"]="invalid language-tagged string",t["INVALID_LANGUAGE_TAGGED_VALUE"]="invalid language-tagged value",t["INVALID_LOCAL_CONTEXT"]="invalid local context",t["INVALID_REMOTE_CONTEXT"]="invalid remote context",t["INVALID_REVERSE_PROPERTY"]="invalid reverse property",t["INVALID_REVERSE_PROPERTY_MAP"]="invalid reverse property map",t["INVALID_REVERSE_PROPERTY_VALUE"]="invalid reverse property value",t["INVALID_SCOPED_CONTEXT"]="invalid scoped context",t["INVALID_SCRIPT_ELEMENT"]="invalid script element",t["INVALID_SET_OR_LIST_OBJECT"]="invalid set or list object",t["INVALID_TERM_DEFINITION"]="invalid term definition",t["INVALID_TYPE_MAPPING"]="invalid type mapping",t["INVALID_TYPE_VALUE"]="invalid type value",t["INVALID_TYPED_VALUE"]="invalid typed value",t["INVALID_VALUE_OBJECT"]="invalid value object",t["INVALID_VALUE_OBJECT_VALUE"]="invalid value object value",t["INVALID_VOCAB_MAPPING"]="invalid vocab mapping",t["IRI_CONFUSED_WITH_PREFIX"]="IRI confused with prefix",t["KEYWORD_REDEFINITION"]="keyword redefinition",t["LOADING_DOCUMENT_FAILED"]="loading document failed",t["LOADING_REMOTE_CONTEXT_FAILED"]="loading remote context failed",t["MULTIPLE_CONTEXT_LINK_HEADERS"]="multiple context link headers",t["PROCESSING_MODE_CONFLICT"]="processing mode conflict",t["PROTECTED_TERM_REDEFINITION"]="protected term redefinition",t["CONTEXT_OVERFLOW"]="context overflow",t["INVALID_BASE_DIRECTION"]="invalid base direction",t["RECURSIVE_CONTEXT_INCLUSION"]="recursive context inclusion",t["INVALID_STREAMING_KEY_ORDER"]="invalid streaming key order",t["INVALID_EMBEDDED_NODE"]="invalid embedded node",t["INVALID_ANNOTATION"]="invalid annotation"}(e.ERROR_CODES||(e.ERROR_CODES={}))},74851:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerType=void 0;const n=i(63636),r=i(61574);class a{canCombineWithGraph(){return!1}async handle(t,e,i,a,s,o){if(!Array.isArray(s)){if("string"===typeof s){const t=await e.getContext(a),n=r.Util.getContextValueType(t,a[o-1]),l="@vocab"===n?await i.createVocabOrBaseTerm(t,s):await i.resourceToTerm(t,s);if(l){const t={"@id":"NamedNode"===l.termType?l.value:s};await e.newOnValueJob(a.slice(0,a.length-1),t,o-1,!0),e.idStack[o+1]=[l]}}else{const t=!!e.idStack[o+1];t||delete e.idStack[o],await e.newOnValueJob(a.slice(0,a.length-1),s,o-1,!0),t||(e.idStack[o+1]=e.idStack[o])}const t=await i.getContainerKey(a[o],a,o),l=null!==t?i.createVocabOrBaseTerm(await e.getContext(a),t):null;l&&await n.EntryHandlerPredicate.handlePredicateObject(e,i,a,o+1,i.rdfType,l,!1,!1,!1),await e.handlePendingContainerFlushBuffers()}e.emittedStack[o]=!1}}e.ContainerHandlerType=a},77318:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Variable=void 0;class i{constructor(t){this.termType="Variable",this.value=t}equals(t){return!!t&&"Variable"===t.termType&&t.value===this.value}}e.Variable=i},83859:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordAnnotation=void 0;const n=i(37954),r=i(46509);class a extends n.EntryHandlerKeyword{constructor(){super("@annotation")}async handle(t,e,i,n,a,s){("string"===typeof a||"object"===typeof a&&a["@value"])&&t.emitError(new r.ErrorCoded(`Found illegal annotation value: ${JSON.stringify(a)}`,r.ERROR_CODES.INVALID_ANNOTATION))}}e.EntryHandlerKeywordAnnotation=a},85856:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordGraph=void 0;const n=i(37954);class r extends n.EntryHandlerKeyword{constructor(){super("@graph")}async handle(t,e,i,n,r,a){t.graphStack[a+1]=!0}}e.EntryHandlerKeywordGraph=r},86397:function(t,e){"use strict";class i{constructor(t,e){this.Impl=t,this.options=e}import(t,e){const i=new this.Impl(t,{...this.options,...e});return t.on("end",(()=>{i.readable||i.emit("end")})),t.on("error",(t=>{i.emit("error",t)})),i}}e.A=i},87692:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(40434),e),r(i(40822),e),r(i(33073),e),r(i(23227),e),r(i(67669),e),r(i(23073),e),r(i(77318),e)},93699:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return p}});var n=i(86397),r=i(65804),a=i(46674),s=i(51016),o=i(14088);const l="null:";function d(t){return e=>"NamedNode"!==e.termType?null:e.value.startsWith(l)?t.namedNode(e.value.slice(l.length)):null}function c(t){const e=d(t);return i=>{const n=e(i.subject),r=e(i.predicate),a=e(i.object),s=e(i.graph);return n||r||a||s?t.quad(n||i.subject,r||i.predicate,a||i.object,s||i.graph):i}}class u{constructor(t,{baseIRI:e=l,context:i=null,documentLoader:n,factory:d=r.A}={}){const u=new s.JsonLdParser({baseIRI:e,context:i,dataFactory:d,documentLoader:n,streamingProfile:!1});t.pipe(u);const h=c(d),f=new o.Transform({objectMode:!0,transform:(t,e,i)=>{i(null,h(t))}});return u.on("context",(t=>{Object.entries(t).forEach((([t,e])=>{f.emit("prefix",t,d.namedNode(e))}))})),u.on("error",(t=>f.destroy(t))),u.pipe(f),(0,a.A)(f)}}var h=u;class f extends n.A{constructor(t){super(h,t)}}var p=f}}]);
//# sourceMappingURL=699.4be6427a.js.map